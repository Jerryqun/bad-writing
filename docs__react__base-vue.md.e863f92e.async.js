"use strict";(self.webpackChunkblog_cq=self.webpackChunkblog_cq||[]).push([[5475],{86912:function(r,a,t){t.r(a);var d=t(72269),u=t(93359),x=t(61788),p=t(19977),c=t(91558),s=t(24268),v=t(96057),h=t(85939),i=t(53683),o=t(80936),l=t(67294),e=t(15465),n=t(85893);function _(){return(0,n.jsx)(i.dY,{children:(0,n.jsx)(l.Suspense,{fallback:(0,n.jsx)(o.Z,{}),children:(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"markdown",children:[(0,n.jsxs)("h2",{id:"react-\u4E0E-vue-\u7684\u4E0D\u540C",children:[(0,n.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#react-\u4E0E-vue-\u7684\u4E0D\u540C",children:(0,n.jsx)("span",{className:"icon icon-link"})}),"React \u4E0E Vue \u7684\u4E0D\u540C"]}),(0,n.jsxs)("p",{children:[e.texts[0].value,(0,n.jsx)("br",{}),e.texts[1].value,(0,n.jsx)("br",{}),e.texts[2].value,(0,n.jsx)("br",{}),e.texts[3].value,(0,n.jsx)("br",{}),e.texts[4].value]}),(0,n.jsxs)("p",{children:[e.texts[5].value,(0,n.jsx)("br",{}),e.texts[6].value,(0,n.jsx)("br",{}),e.texts[7].value]}),(0,n.jsxs)("p",{children:[e.texts[8].value,(0,n.jsx)(i.rU,{to:"/vue#vue2-vue3-react-%E4%B8%89%E8%80%85-diff-%E7%AE%97%E6%B3%95%E6%9C%89%E4%BD%95%E5%8C%BA%E5%88%AB",children:e.texts[9].value})]}),(0,n.jsxs)("p",{children:[e.texts[10].value,(0,n.jsx)("br",{}),e.texts[11].value,(0,n.jsx)("br",{}),e.texts[12].value]}),(0,n.jsxs)("h2",{id:"mvvm-modalviewviewmodal",children:[(0,n.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#mvvm-modalviewviewmodal",children:(0,n.jsx)("span",{className:"icon icon-link"})}),"MVVM \uFF08Modal\u3001View\u3001ViewModal\uFF09"]}),(0,n.jsxs)("p",{children:[e.texts[13].value,(0,n.jsx)("br",{}),e.texts[14].value,(0,n.jsx)("br",{}),e.texts[15].value]}),(0,n.jsxs)("h2",{id:"mvc-modelviewcontroller",children:[(0,n.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#mvc-modelviewcontroller",children:(0,n.jsx)("span",{className:"icon icon-link"})}),"MVC (Model\u3001View\u3001Controller)"]}),(0,n.jsxs)("p",{children:[e.texts[16].value,(0,n.jsx)("br",{}),e.texts[17].value,(0,n.jsx)("br",{}),e.texts[18].value]}),(0,n.jsxs)("h2",{id:"\u7B80\u6613\u7684-mvvm-\u5B9E\u73B0-\u57FA\u4E8E-proxy",children:[(0,n.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#\u7B80\u6613\u7684-mvvm-\u5B9E\u73B0-\u57FA\u4E8E-proxy",children:(0,n.jsx)("span",{className:"icon icon-link"})}),"\u7B80\u6613\u7684 mvvm \u5B9E\u73B0 \u57FA\u4E8E proxy"]}),(0,n.jsx)(s.Z,{lang:"html",children:e.texts[19].value})]})})})})}a.default=_},15465:function(r,a,t){t.r(a),t.d(a,{texts:function(){return d}});const d=[{value:"\u4E0D\u540C\u70B9",paraId:0,tocIndex:0},{value:`
1\u3001React \u65E2\u4E0D\u5C5E\u4E8E MVC \u4E5F\u4E0D\u5C5E\u4E8E MVVM \u67B6\u6784\uFF1B Vue \u662F\u4E00\u4E2A\u7075\u6D3B\u6613\u7528\u7684\u6E10\u8FDB\u5F0F\u53CC\u5411\u7ED1\u5B9A\u7684 MVVM \u6846\u67B6`,paraId:0,tocIndex:0},{value:`
\u6838\u5FC3\u601D\u60F3`,paraId:0,tocIndex:0},{value:`
vue\uFF1A\u6E10\u8FDB\u5F0F\u53CC\u5411\u7ED1\u5B9A\u7684 MVVM \u6846\u67B6`,paraId:0,tocIndex:0},{value:`
react\uFF1A \u58F0\u660E\u5F0F\u6E32\u67D3\u548C\u7EC4\u4EF6\u5316\u3001\u5355\u5411\u6570\u636E\u6D41`,paraId:0,tocIndex:0},{value:"2\u3001\u54CD\u5E94\u539F\u7406",paraId:1,tocIndex:0},{value:`
React\uFF1A\u4E3B\u8981\u662F\u901A\u8FC7\u624B\u52A8\u8C03\u7528 setState()\u65B9\u6CD5\u6765\u66F4\u65B0\u72B6\u6001\uFF0C\u72B6\u6001\u66F4\u65B0\u4E4B\u540E\uFF0C\u7EC4\u4EF6\u4E5F\u4F1A\u91CD\u65B0\u6E32\u67D3`,paraId:1,tocIndex:0},{value:`
Vue\uFF1A\u904D\u5386 data \u6570\u636E\u5BF9\u8C61\uFF0C\u4F7F\u7528 Object.definedProperty \u5C06\u6BCF\u4E2A\u5C5E\u6027\u90FD\u8F6C\u6362\u4E3A getter \u548C setter\uFF0C\u6BCF\u4E2A Vue \u5B9E\u4F8B\u90FD\u6709\u4E00\u4E2A\u5BF9\u5E94\u7684 watcher \u5B9E\u4F8B\uFF0C\u5728\u7EC4\u4EF6\u521D\u6B21\u6E32\u67D3\u7684\u65F6\u5019\u4F1A\u8BB0\u5F55\u7EC4\u4EF6\u7528\u5230\u4E86\u54EA\u4E9B\u6570\u636E\uFF0C\u5F53\u6570\u636E\u53D1\u751F\u6539\u53D8\u7684\u65F6\u5019\u89E6\u53D1 setter \u65B9\u6CD5\uFF0C\u5E76\u901A\u77E5\u6240\u6709\u4F9D\u8D56\u5728\u8FD9\u4E2A\u6570\u636E\u7684 watcher \u5B9E\u4F8B\u8C03\u7528 update \u65B9\u6CD5\u89E6\u53D1\u7EC4\u4EF6\u7684 compile \u6E32\u67D3\u65B9\u6CD5\uFF0C\u8FDB\u884C\u6E32\u67D3\u6570\u636E`,paraId:1,tocIndex:0},{value:"3\u3001 ",paraId:2,tocIndex:0},{value:"diff \u7B97\u6CD5\u4E0D\u540C",paraId:3,tocIndex:0},{value:"4\u3001\u4E66\u5199",paraId:4,tocIndex:0},{value:`
react \u57FA\u4E8E jsx \u9762\u5411 js`,paraId:4,tocIndex:0},{value:`
vue \u57FA\u4E8E templete \u9762\u5411 html`,paraId:4,tocIndex:0},{value:"Modal: \u6570\u636E\u6A21\u578B\u5C42\uFF0C\u8D1F\u8D23\u4E1A\u52A1\u6570\u636E\u548C\u72B6\u6001\uFF0C\u901A\u5E38\u662F\u7EAF\u6570\u636E\u7ED3\u6784\u6216\u903B\u8F91\u5904\u7406",paraId:5,tocIndex:1},{value:`
View: \u89C6\u56FE\u5C42\uFF0C\u8D1F\u8D23 UI \u5C55\u793A\uFF0C\u7528\u6237\u754C\u9762\u5143\u7D20\u548C\u4EA4\u4E92`,paraId:5,tocIndex:1},{value:`
ViewModal: \u89C6\u56FE\u6A21\u578B\u5C42\uFF0C\u8FDE\u63A5 Model \u548C View\uFF0C\u8D1F\u8D23\u6570\u636E\u7ED1\u5B9A\u548C\u5904\u7406\u7528\u6237\u4EA4\u4E92\u903B\u8F91`,paraId:5,tocIndex:1},{value:"Model\uFF1A\u6570\u636E\u6A21\u578B\u5C42\uFF0C\u8D1F\u8D23\u7BA1\u7406\u5E94\u7528\u7684\u6570\u636E\u3001\u4E1A\u52A1\u903B\u8F91\u548C\u72B6\u6001",paraId:6,tocIndex:2},{value:`
View\uFF1A\u89C6\u56FE\u5C42\uFF0C\u8D1F\u8D23\u6570\u636E\u663E\u793A\u548C\u7528\u6237\u754C\u9762\u5448\u73B0`,paraId:6,tocIndex:2},{value:`
Controller\uFF1A\u63A7\u5236\u5668\u5C42\uFF0C\u8D1F\u8D23\u63A5\u6536\u7528\u6237\u8F93\u5165\u5E76\u8C03\u7528 Model \u4E0E View \u8FDB\u884C\u4EA4\u4E92\u548C\u66F4\u65B0`,paraId:6,tocIndex:2},{value:`<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>\u7B80\u6613MVVM\u6846\u67B6Demo\uFF08Proxy\u7248\uFF0C\u4FEE\u6B63\uFF09</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 20px;
      }
      input {
        padding: 5px;
        font-size: 16px;
      }
    </style>
  </head>
  <body>
    <script>
      class MVVM {
        constructor(options) {
          this.$el =
            typeof options.el === 'string'
              ? document.querySelector(options.el)
              : options.el;
          // this.$data = options.data;

          this._bindings = {}; // \u5B58\u653E\u7ED1\u5B9A\u4FE1\u606F

          this.$data = this._proxyData(options.data || {});

          this._compile(this.$el);
        }

        _proxyData(data) {
          const self = this;
          return new Proxy(data, {
            get(target, prop) {
              return target[prop];
            },
            set(target, prop, value) {
              target[prop] = value;
              self._update(prop, value);
              return true;
            },
          });
        }

        _compile(el) {
          const nodes = el.querySelectorAll('*');

          nodes.forEach((node) => {
            // \u5904\u7406\u6587\u672C\u8282\u70B9\u7684 {{}} \u7ED1\u5B9A
            node.childNodes.forEach((child) => {
              if (child.nodeType === 3) {
                const reg = /\\{\\{\\s*([^\\s\\{\\}]+)\\s*\\}\\}/g;
                const text = child.textContent;
                if (reg.test(text)) {
                  // \u8BB0\u5F55\u6A21\u677F\u539F\u6587
                  const prop = RegExp.$1;
                  this._addBinding(prop, child, 'text', text);

                  this._update(prop, this.$data[prop]);
                }
              }
            });

            // \u5904\u7406 v-model \u6307\u4EE4
            if (node.hasAttribute && node.hasAttribute('v-model')) {
              const prop = node.getAttribute('v-model');
              this._addBinding(prop, node, 'input');

              node.value = this.$data[prop];

              node.addEventListener('input', (e) => {
                this.$data[prop] = e.target.value;
              });
            }
          });
        }

        _addBinding(prop, node, type, template = null) {
          if (!this._bindings[prop]) this._bindings[prop] = [];
          this._bindings[prop].push({ node, type, template });
        }

        _update(prop, value) {
          if (!this._bindings[prop]) return;
          this._bindings[prop].forEach((binding) => {
            if (binding.type === 'text') {
              const originalText = binding.template; // \u8FD9\u91CC\u7528\u4FDD\u5B58\u7684\u6A21\u677F\u6587\u672C
              if (!originalText) return;
              const reg = new RegExp(\`\\\\{\\\\{\\\\s*\${prop}\\\\s*\\\\}\\\\}\`, 'g');
              binding.node.textContent = originalText.replace(reg, value);
            } else if (
              binding.type === 'input' &&
              binding.node.value !== value
            ) {
              binding.node.value = value;
            }
          });
        }
      }

      // \u4F7F\u7528\u793A\u4F8B
      const vm = new MVVM({
        el: '#app',
        data: {
          message: '\u6B22\u8FCE\u4F7F\u7528\u7B80\u6613MVVM\u6846\u67B6',
        },
      });
    <\/script>
  </body>
</html>
`,paraId:7,tocIndex:3}]}}]);

"use strict";(self.webpackChunkblog_cq=self.webpackChunkblog_cq||[]).push([[1109],{30245:function(o,r,a){a.r(r);var s=a(72269),u=a(93359),p=a(61788),x=a(19977),m=a(91558),t=a(24268),h=a(96057),v=a(85939),l=a(53683),i=a(80936),c=a(67294),n=a(67323),e=a(85893);function d(){return(0,e.jsx)(l.dY,{children:(0,e.jsx)(c.Suspense,{fallback:(0,e.jsx)(i.Z,{}),children:(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{className:"markdown",children:[(0,e.jsxs)("h2",{id:"\u524D\u8A00",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#\u524D\u8A00",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"\u524D\u8A00"]}),(0,e.jsx)("p",{children:n.texts[0].value}),(0,e.jsx)("p",{children:n.texts[1].value}),(0,e.jsxs)("h2",{id:"1-\u529F\u80FD\u521B\u5EFA\u6E05\u5355",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#1-\u529F\u80FD\u521B\u5EFA\u6E05\u5355",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"1. \u529F\u80FD\uFF1A\u521B\u5EFA\u6E05\u5355"]}),(0,e.jsxs)("h3",{id:"\u5B9E\u73B0\u524D\u7AEF\u6821\u9A8Crhf--zod",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#\u5B9E\u73B0\u524D\u7AEF\u6821\u9A8Crhf--zod",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"\u5B9E\u73B0\u524D\u7AEF\u6821\u9A8C\uFF08RHF + Zod\uFF09"]}),(0,e.jsx)("p",{children:n.texts[2].value}),(0,e.jsx)(t.Z,{lang:"bash",children:n.texts[3].value}),(0,e.jsxs)("p",{children:[n.texts[4].value,(0,e.jsx)("code",{children:n.texts[5].value}),n.texts[6].value]}),(0,e.jsx)(t.Z,{lang:"typescript",children:n.texts[7].value}),(0,e.jsx)("p",{children:n.texts[8].value}),(0,e.jsxs)("p",{children:[n.texts[9].value,(0,e.jsx)("code",{children:n.texts[10].value}),n.texts[11].value]}),(0,e.jsx)(t.Z,{lang:"typescript",children:n.texts[12].value}),(0,e.jsxs)("p",{children:[n.texts[13].value,(0,e.jsx)("code",{children:n.texts[14].value}),n.texts[15].value]}),(0,e.jsx)(t.Z,{lang:"js",children:n.texts[16].value}),(0,e.jsx)("p",{children:n.texts[17].value}),(0,e.jsxs)("ol",{children:[(0,e.jsx)("li",{children:n.texts[18].value}),(0,e.jsxs)("li",{children:[n.texts[19].value,(0,e.jsx)("code",{children:n.texts[20].value}),n.texts[21].value,(0,e.jsx)("code",{children:n.texts[22].value}),n.texts[23].value]})]}),(0,e.jsx)(t.Z,{lang:"js",children:n.texts[24].value}),(0,e.jsx)("blockquote",{children:(0,e.jsxs)("p",{children:[n.texts[25].value,(0,e.jsx)("a",{href:"https://ui.shadcn.com/docs/components/sheet",children:n.texts[26].value}),n.texts[27].value,(0,e.jsx)("a",{href:"https://www.radix-ui.com/primitives/docs/components/dialog",children:n.texts[28].value}),n.texts[29].value]})}),(0,e.jsx)("p",{children:n.texts[30].value}),(0,e.jsx)("p",{children:(0,e.jsx)("img",{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/02ec7e44db0d45048de37b19f03b23c1~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1001&h=610&s=230694&e=gif&f=53&b=fefefe",alt:"t3-8.gif"})}),(0,e.jsx)("p",{children:n.texts[31].value}),(0,e.jsxs)("h3",{id:"\u5B9E\u73B0\u670D\u52A1\u7AEF\u903B\u8F91server-actions",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#\u5B9E\u73B0\u670D\u52A1\u7AEF\u903B\u8F91server-actions",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"\u5B9E\u73B0\u670D\u52A1\u7AEF\u903B\u8F91\uFF08Server Actions\uFF09"]}),(0,e.jsxs)("p",{children:[n.texts[32].value,(0,e.jsx)("code",{children:n.texts[33].value}),n.texts[34].value]}),(0,e.jsx)(t.Z,{lang:"js",children:n.texts[35].value}),(0,e.jsxs)("p",{children:[n.texts[36].value,(0,e.jsx)("code",{children:n.texts[37].value}),n.texts[38].value]}),(0,e.jsx)(t.Z,{lang:"js",children:n.texts[39].value}),(0,e.jsx)("p",{children:n.texts[40].value}),(0,e.jsx)("p",{children:(0,e.jsx)("img",{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/122b0e3183434b369de61321fac4458a~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1001&h=610&s=281531&e=gif&f=59&b=fdfdfd",alt:"t3-8.gif"})}),(0,e.jsx)("p",{children:n.texts[41].value}),(0,e.jsxs)("h3",{id:"\u6DFB\u52A0-toast-\u6548\u679Cshadcn-ui",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#\u6DFB\u52A0-toast-\u6548\u679Cshadcn-ui",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"\u6DFB\u52A0 toast \u6548\u679C\uFF08Shadcn UI\uFF09"]}),(0,e.jsxs)("p",{children:[n.texts[42].value,(0,e.jsx)("code",{children:n.texts[43].value}),n.texts[44].value]}),(0,e.jsxs)("p",{children:[n.texts[45].value,(0,e.jsx)("code",{children:n.texts[46].value}),n.texts[47].value]}),(0,e.jsx)(t.Z,{lang:"js",children:n.texts[48].value}),(0,e.jsxs)("p",{children:[n.texts[49].value,(0,e.jsx)("code",{children:n.texts[50].value}),n.texts[51].value]}),(0,e.jsx)(t.Z,{lang:"js",children:n.texts[52].value}),(0,e.jsx)("p",{children:n.texts[53].value}),(0,e.jsx)("p",{children:(0,e.jsx)("img",{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1d9ae0e5970b4e3c934bfcd68d9f5cd4~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1072&h=583&s=194100&e=gif&f=47&b=fefefe",alt:"t3-10.gif"})}),(0,e.jsx)("p",{children:n.texts[54].value}),(0,e.jsx)("p",{children:n.texts[55].value}),(0,e.jsxs)("ol",{children:[(0,e.jsx)("li",{children:n.texts[56].value}),(0,e.jsx)("li",{children:n.texts[57].value})]}),(0,e.jsx)("p",{children:n.texts[58].value}),(0,e.jsxs)("p",{children:[n.texts[59].value,(0,e.jsx)("code",{children:n.texts[60].value}),n.texts[61].value]}),(0,e.jsx)(t.Z,{lang:"diff",children:n.texts[62].value}),(0,e.jsxs)("p",{children:[n.texts[63].value,(0,e.jsx)("code",{children:n.texts[64].value}),n.texts[65].value]}),(0,e.jsx)(t.Z,{lang:"js",children:n.texts[66].value}),(0,e.jsx)("p",{children:n.texts[67].value}),(0,e.jsx)("p",{children:(0,e.jsx)("img",{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/78171537a7fe4d30b4845f6bbc5a7ee8~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1072&h=583&s=220477&e=gif&f=38&b=fefefe",alt:"t3-11.gif"})}),(0,e.jsxs)("h3",{id:"prisma-\u4E0E\u6570\u636E\u5E93\u64CD\u4F5Cprisma",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#prisma-\u4E0E\u6570\u636E\u5E93\u64CD\u4F5Cprisma",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Prisma \u4E0E\u6570\u636E\u5E93\u64CD\u4F5C\uFF08Prisma\uFF09"]}),(0,e.jsxs)("p",{children:[n.texts[68].value,(0,e.jsx)("code",{children:n.texts[69].value}),n.texts[70].value]}),(0,e.jsx)(t.Z,{lang:"js",children:n.texts[71].value}),(0,e.jsxs)("p",{children:[n.texts[72].value,(0,e.jsx)("code",{children:n.texts[73].value}),n.texts[74].value]}),(0,e.jsx)(t.Z,{children:n.texts[75].value}),(0,e.jsx)("p",{children:n.texts[76].value}),(0,e.jsx)(t.Z,{lang:"bash",children:n.texts[77].value}),(0,e.jsxs)("p",{children:[n.texts[78].value,(0,e.jsx)("code",{children:n.texts[79].value}),n.texts[80].value]}),(0,e.jsx)(t.Z,{lang:"js",children:n.texts[81].value}),(0,e.jsx)("p",{children:n.texts[82].value}),(0,e.jsx)(t.Z,{lang:"bash",children:n.texts[83].value}),(0,e.jsx)("p",{children:n.texts[84].value}),(0,e.jsx)("p",{children:(0,e.jsx)("img",{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bca8556744954f1f8b67580225f00b6b~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1072&h=605&s=365641&e=gif&f=75&b=fefefe",alt:"t3-12.gif"})}),(0,e.jsx)("p",{children:n.texts[85].value}),(0,e.jsxs)("h2",{id:"2-\u529F\u80FD\u5C55\u793A\u6E05\u5355",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#2-\u529F\u80FD\u5C55\u793A\u6E05\u5355",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"2. \u529F\u80FD\uFF1A\u5C55\u793A\u6E05\u5355"]}),(0,e.jsxs)("p",{children:[n.texts[86].value,(0,e.jsx)("code",{children:n.texts[87].value}),n.texts[88].value]}),(0,e.jsx)(t.Z,{lang:"js",children:n.texts[89].value}),(0,e.jsxs)("p",{children:[n.texts[90].value,(0,e.jsx)("code",{children:n.texts[91].value}),n.texts[92].value]}),(0,e.jsx)(t.Z,{lang:"js",children:n.texts[93].value}),(0,e.jsxs)("p",{children:[n.texts[94].value,(0,e.jsx)("code",{children:n.texts[95].value}),n.texts[96].value]}),(0,e.jsx)(t.Z,{lang:"js",children:n.texts[97].value}),(0,e.jsx)("p",{children:n.texts[98].value}),(0,e.jsx)("p",{children:(0,e.jsx)("img",{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2c4aa8d663d54db2975bd40eb450a48f~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1291&h=731&s=326345&e=gif&f=67&b=fefefe",alt:"t3-13.gif"})}),(0,e.jsx)("p",{children:n.texts[99].value}),(0,e.jsxs)("h2",{id:"3-\u529F\u80FD\u5220\u9664\u6E05\u5355",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#3-\u529F\u80FD\u5220\u9664\u6E05\u5355",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"3. \u529F\u80FD\uFF1A\u5220\u9664\u6E05\u5355"]}),(0,e.jsxs)("p",{children:[n.texts[100].value,(0,e.jsx)("code",{children:n.texts[101].value}),n.texts[102].value]}),(0,e.jsx)(t.Z,{lang:"typescript",children:n.texts[103].value}),(0,e.jsxs)("p",{children:[n.texts[104].value,(0,e.jsx)("code",{children:n.texts[105].value}),n.texts[106].value]}),(0,e.jsx)(t.Z,{lang:"js",children:n.texts[107].value}),(0,e.jsx)("p",{children:n.texts[108].value}),(0,e.jsx)("p",{children:(0,e.jsx)("img",{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e5ffe01f523848bcac41a084fe6b8688~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1291&h=731&s=326345&e=gif&f=67&b=fefefe",alt:"t3-13.gif"})}),(0,e.jsxs)("h2",{id:"\u4E0B\u4E00\u7BC7",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#\u4E0B\u4E00\u7BC7",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"\u4E0B\u4E00\u7BC7"]}),(0,e.jsx)("blockquote",{children:(0,e.jsxs)("ol",{children:[(0,e.jsx)("li",{children:n.texts[109].value}),(0,e.jsxs)("li",{children:[n.texts[110].value,(0,e.jsx)("a",{href:"https://github.com/mqyqingfeng/next-app-demo/tree/next-t3-todo-2",children:n.texts[111].value})]}),(0,e.jsxs)("li",{children:[n.texts[112].value,(0,e.jsx)("code",{children:n.texts[113].value})]})]})}),(0,e.jsx)("p",{children:n.texts[114].value})]})})})})}r.default=d},67323:function(o,r,a){a.r(r),a.d(r,{texts:function(){return s}});const s=[{value:"\u672C\u7BC7\u6211\u4EEC\u5C06\u5B9E\u73B0\u6E05\u5355\u7684\u589E\u5220\u67E5\u529F\u80FD\u3002",paraId:0,tocIndex:0},{value:"\u90A3\u5C31\u8BA9\u6211\u4EEC\u63A5\u7740\u5F00\u59CB\u5427\uFF01",paraId:1,tocIndex:0},{value:"\u8868\u5355\u5904\u7406\u4F7F\u7528 React Hook Form \u548C Zod\u3002\u5B89\u88C5\u4F9D\u8D56\u9879\uFF1A",paraId:2,tocIndex:2},{value:`npm i react-hook-form zod @hookform/resolvers
`,paraId:3,tocIndex:2},{value:"\u65B0\u5EFA ",paraId:4,tocIndex:2},{value:"src/lib/const.ts",paraId:4,tocIndex:2},{value:"\uFF0C\u4EE3\u7801\u5982\u4E0B\uFF1A",paraId:4,tocIndex:2},{value:`export const ListMap = new Map([
  ['rose', ['bg-rose-500', '\u73AB\u7470']],
  ['amber', ['bg-amber-500', '\u7425\u73C0']],
  ['orange', ['bg-orange-500', '\u6A58\u6A59']],
  ['green', ['bg-lime-500', '\u8349\u7EFF']],
  ['cyan', ['bg-sky-500', '\u5929\u84DD']],
  ['indigo', ['bg-indigo-500', '\u8461\u7D2B']],
  ['pink', ['bg-pink-500', '\u7C89\u7C89']],
  ['black', ['bg-black', '\u9ED1\u8272']],
]);
`,paraId:5,tocIndex:2},{value:"\u5728\u8FD9\u6BB5\u4EE3\u7801\u4E2D\uFF0C\u4F7F\u7528 Map \u5EFA\u7ACB\u989C\u8272\u4E0E\u8272\u503C\u3001\u4E2D\u6587\u540D\u7684\u6620\u5C04\u5173\u7CFB\u3002",paraId:6,tocIndex:2},{value:"\u65B0\u5EFA ",paraId:7,tocIndex:2},{value:"src/schema/createList.ts",paraId:7,tocIndex:2},{value:"\uFF0C\u4EE3\u7801\u5982\u4E0B\uFF1A",paraId:7,tocIndex:2},{value:`import { z } from 'zod';
import { ListMap } from '@/lib/const';

export const createListZodSchema = z.object({
  name: z.string().min(1, {
    message: '\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A',
  }),
  color: z
    .string()
    .min(1, {
      message: '\u8BF7\u9009\u62E9\u4E00\u4E2A\u989C\u8272',
    })
    .refine((color) => [...ListMap.keys()].includes(color)),
});

export type createListZodSchemaType = z.infer<typeof createListZodSchema>;
`,paraId:8,tocIndex:2},{value:"\u4FEE\u6539 ",paraId:9,tocIndex:2},{value:"src/components/CreateListModal.tsx",paraId:9,tocIndex:2},{value:"\uFF0C\u5B8C\u6574\u4EE3\u7801\u5982\u4E0B\uFF1A",paraId:9,tocIndex:2},{value:`'use client';

import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import {
  Sheet,
  SheetContent,
  SheetDescription,
  SheetFooter,
  SheetHeader,
  SheetTitle,
  SheetTrigger,
} from '@/components/ui/sheet';
import {
  Form,
  FormControl,
  FormField,
  FormItem,
  FormLabel,
  FormMessage,
} from '@/components/ui/form';
import {
  Select,
  SelectContent,
  SelectGroup,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from '@/components/ui/select';

import { useForm } from 'react-hook-form';
import { zodResolver } from '@hookform/resolvers/zod';

import {
  createListZodSchema,
  type createListZodSchemaType,
} from '@/schema/createList';
import { cn } from '@/lib/utils';
import { ListMap } from '@/lib/const';
import { useState } from 'react';

export default function CreateListModal() {
  const form = useForm({
    resolver: zodResolver(createListZodSchema),
    defaultValues: {
      name: '',
      color: '',
    },
  });

  const [open, setOpen] = useState(false);

  const onSubmit = async (data: createListZodSchemaType) => {
    console.log(data);
    setOpen(false);
  };

  const onOpenChange = (open: boolean) => {
    form.reset();
    setOpen(open);
  };

  return (
    <Sheet open={open} onOpenChange={onOpenChange}>
      <SheetTrigger asChild>
        <Button>\u6DFB\u52A0\u6E05\u5355</Button>
      </SheetTrigger>
      <SheetContent>
        <SheetHeader>
          <SheetTitle>\u6DFB\u52A0\u6E05\u5355</SheetTitle>
          <SheetDescription>
            \u6E05\u5355\u662F\u4EFB\u52A1\u7684\u96C6\u5408\uFF0C\u6BD4\u5982\u201C\u5DE5\u4F5C\u201D\u3001\u201C\u751F\u6D3B\u201D\u3001\u201C\u526F\u4E1A\u201D
          </SheetDescription>
        </SheetHeader>
        <Form {...form}>
          <form
            onSubmit={form.handleSubmit(onSubmit)}
            className="space-y-8 p-4"
          >
            <FormField
              control={form.control}
              name="name"
              render={({ field }) => (
                <FormItem>
                  <FormLabel>\u8BBE\u7F6E\u6E05\u5355\u7684\u540D\u79F0\uFF1A</FormLabel>
                  <FormControl>
                    <Input placeholder="\u4F8B\u5982\uFF1A\u5DE5\u4F5C" {...field} />
                  </FormControl>
                  <FormMessage />
                </FormItem>
              )}
            />
            <FormField
              control={form.control}
              name="color"
              render={({ field }) => (
                <FormItem>
                  <FormLabel>\u9009\u62E9\u6E05\u5355\u7684\u80CC\u666F\u8272\uFF1A</FormLabel>
                  <FormControl>
                    <Select onValueChange={(color) => field.onChange(color)}>
                      <SelectTrigger
                        className={cn('w-[180px]', ListMap.get(field.value), {
                          'text-white': !!field.value,
                        })}
                      >
                        <SelectValue placeholder="\u989C\u8272" />
                      </SelectTrigger>
                      <SelectContent>
                        <SelectGroup>
                          {[...ListMap.entries()].map(
                            ([color, [className, name]]) => {
                              return (
                                <SelectItem
                                  key={color}
                                  value={color}
                                  className={cn(
                                    'my-1 w-full rounded-md text-white ring-black focus:font-bold focus:text-white focus:ring-2 dark:ring-white',
                                    className,
                                    \`focus:\${className}\`,
                                  )}
                                >
                                  {name}
                                </SelectItem>
                              );
                            },
                          )}
                        </SelectGroup>
                      </SelectContent>
                    </Select>
                  </FormControl>
                  <FormMessage />
                </FormItem>
              )}
            />
          </form>
        </Form>
        <SheetFooter>
          <Button
            onClick={form.handleSubmit(onSubmit)}
            className="w-full"
            disabled={form.formState.isSubmitting}
          >
            \u521B\u5EFA
          </Button>
        </SheetFooter>
      </SheetContent>
    </Sheet>
  );
}
`,paraId:10,tocIndex:2},{value:"\u5728\u8FD9\u6BB5\u4EE3\u7801\u4E2D \uFF0C\u6709\u51E0\u70B9\u9700\u8981\u6CE8\u610F\uFF1A",paraId:11,tocIndex:2},{value:"\u6211\u4EEC\u4F7F\u7528 React Hook Form \u7684 useForm \u548C zodResolver \u5B8C\u6210\u4E86\u524D\u7AEF\u6570\u636E\u6821\u9A8C",paraId:12,tocIndex:2},{value:"Shadcn UI \u867D\u7136\u63D0\u4F9B\u4E86 ",paraId:12,tocIndex:2},{value:"<SheetTrigger>",paraId:12,tocIndex:2},{value:" \u548C ",paraId:12,tocIndex:2},{value:"<SheetClose>",paraId:12,tocIndex:2},{value:"\u7528\u4E8E\u63A7\u5236 Sheet \u7684\u6253\u5F00\u548C\u5173\u95ED\uFF0C\u4F46\u662F\u5F53\u7528\u6237\u63D0\u4EA4\u6570\u636E\uFF0C\u9A8C\u8BC1\u901A\u8FC7\u7684\u65F6\u5019\u624D\u80FD\u5173\u95ED Sheet\uFF0C\u6240\u4EE5\u9700\u8981\u6539\u4E3A\u624B\u52A8\u63A7\u5236\uFF1A",paraId:12,tocIndex:2},{value:`const [open, setOpen] = useState(false);

return <Sheet open={open} onOpenChange={setOpen} />;
`,paraId:13,tocIndex:2},{value:"\u6CE8\u610F\uFF1A\u8FD9\u4E9B\u5C5E\u6027\u867D\u7136\u5728 Sheet \u7684",paraId:14,tocIndex:2},{value:"\u6587\u6863",paraId:14,tocIndex:2},{value:"\u91CC\u627E\u4E0D\u5230\u8BF4\u660E\uFF0C\u4F46\u53EF\u4EE5\u627E\u5230\u5BF9\u5E94\u7684 Radix \u7EC4\u4EF6",paraId:14,tocIndex:2},{value:"\u6587\u6863",paraId:14,tocIndex:2},{value:"\u94FE\u63A5\u3002",paraId:14,tocIndex:2},{value:"\u6B64\u65F6\u6D4F\u89C8\u5668\u6548\u679C\u5982\u4E0B\uFF1A",paraId:15,tocIndex:2},{value:"\u6548\u679C\u63CF\u8FF0\uFF1A\u5F53\u70B9\u51FB\u201C\u6DFB\u52A0\u6E05\u5355\u201D\u6309\u94AE\u7684\u65F6\u5019\uFF0C\u53F3\u4FA7\u5F39\u51FA\u521B\u5EFA\u6E05\u5355\u8868\u5355\u3002\u5F53\u63D0\u4EA4\u7684\u65F6\u5019\uFF0C\u89E6\u53D1\u524D\u7AEF\u6821\u9A8C\uFF0C\u6570\u636E\u6821\u9A8C\u901A\u8FC7\u540E\uFF0C\u6D4F\u89C8\u5668\u547D\u4EE4\u884C\u4E2D\u6253\u5370\u4E86\u63D0\u4EA4\u7684\u6570\u636E\uFF0C\u6E05\u5355\u8868\u5355\u5173\u95ED\u3002",paraId:16,tocIndex:2},{value:"\u65B0\u5EFA ",paraId:17,tocIndex:3},{value:"src/actions/list.ts",paraId:17,tocIndex:3},{value:"\uFF0C\u4EE3\u7801\u5982\u4E0B\uFF1A",paraId:17,tocIndex:3},{value:`'use server';

import {
  createListZodSchema,
  type createListZodSchemaType,
} from '@/schema/createList';
import { currentUser } from '@clerk/nextjs/server';
import { revalidatePath } from 'next/cache';

export async function createList(data: createListZodSchemaType) {
  const user = await currentUser();

  if (!user) {
    throw new Error('\u7528\u6237\u672A\u767B\u5F55\uFF0C\u8BF7\u5148\u767B\u5F55');
  }

  const result = createListZodSchema.safeParse(data);

  if (!result.success) {
    return {
      success: false,
      message: result.error.flatten().fieldErrors,
    };
  }

  // Todo: \u6570\u636E\u5E93\u5904\u7406
  console.log(data);

  revalidatePath('/');

  return {
    success: true,
    message: '\u6E05\u5355\u521B\u5EFA\u6210\u529F',
  };
}
`,paraId:18,tocIndex:3},{value:"\u4FEE\u6539 ",paraId:19,tocIndex:3},{value:"src/components/CreateListModal.tsx",paraId:19,tocIndex:3},{value:"\uFF0C\u4EE3\u7801\u5982\u4E0B\uFF1A",paraId:19,tocIndex:3},{value:`"use client";

// ...
import { createList } from "@/actions/list";

export default function CreateListModal() {
  // ...

  const onSubmit = async (data: createListZodSchemaType) => {
    try {
      await createList(data);
      onOpenChange(false);
      console.log("success");
    } catch (e) {
      console.log(e);
    }
  };

  // ...

  return (
  // ...
  );
}
`,paraId:20,tocIndex:3},{value:"\u6D4F\u89C8\u5668\u6548\u679C\u5982\u4E0B\uFF1A",paraId:21,tocIndex:3},{value:"\u6548\u679C\u63CF\u8FF0\uFF1A\u5F53\u63D0\u4EA4\u6570\u636E\u7684\u65F6\u5019\uFF0C\u4F1A\u89E6\u53D1\u8BF7\u6C42\uFF0C\u6210\u529F\u540E\uFF0C\u6D4F\u89C8\u5668\u63A7\u5236\u53F0\u6253\u5370\u4E86 success",paraId:22,tocIndex:3},{value:"\u5F53\u521B\u5EFA\u7684\u65F6\u5019\uFF0C\u65E0\u8BBA\u6210\u529F\u8FD8\u662F\u5931\u8D25\uFF0C\u90FD\u5E94\u8BE5\u6709\u4E00\u4E2A\u6D88\u606F\u63D0\u793A\uFF0C\u6240\u4EE5\u6211\u4EEC\u5F15\u5165 Shadcn UI \u7684 ",paraId:23,tocIndex:4},{value:"<Toaster>",paraId:23,tocIndex:4},{value:" \u7EC4\u4EF6\u3002",paraId:23,tocIndex:4},{value:"\u4FEE\u6539 ",paraId:24,tocIndex:4},{value:"src/app/layout.tsx",paraId:24,tocIndex:4},{value:"\uFF0C\u6DFB\u52A0\u4EE3\u7801\u5982\u4E0B\uFF1A",paraId:24,tocIndex:4},{value:`// ...
import { Toaster } from '@/components/ui/toaster';

export default function RootLayout({
  children,
}: Readonly<{ children: React.ReactNode }>) {
  const localization = merge(zhCN, zhCNlocales);
  return (
    <ClerkProvider localization={localization}>
      <html
        lang="zh-CN"
        className={\`\${GeistSans.variable}\`}
        suppressHydrationWarning
      >
        <body>
          <ThemeProvider
            attribute="class"
            defaultTheme="system"
            enableSystem
            disableTransitionOnChange
          >
            <Header />
            <div className="flex w-full flex-col items-center">{children}</div>
            <Toaster />
          </ThemeProvider>
        </body>
      </html>
    </ClerkProvider>
  );
}
`,paraId:25,tocIndex:4},{value:"\u4FEE\u6539 ",paraId:26,tocIndex:4},{value:"src/components/CreateListModal.tsx",paraId:26,tocIndex:4},{value:"\uFF0C\u4EE3\u7801\u5982\u4E0B\uFF1A",paraId:26,tocIndex:4},{value:`"use client";

// ...
import { toast } from "@/components/ui/use-toast";

export default function CreateListModal() {
  // ...

  const onSubmit = async (data: createListZodSchemaType) => {
    try {
      await createList(data);
      onOpenChange(false);
      toast({
        title: "\u606D\u559C\u60A8",
        description: "\u6E05\u5355\u521B\u5EFA\u6210\u529F\uFF01",
      });
    } catch (e) {
      console.log(e);
      toast({
        title: "\u54CE\u5466",
        description: "\u6E05\u5355\u521B\u5EFA\u5931\u8D25",
        variant: "destructive",
      });
    }
  };

  // ...

  return (
  // ...
  );
}
`,paraId:27,tocIndex:4},{value:"\u6B64\u65F6\u6D4F\u89C8\u5668\u6548\u679C\u5982\u4E0B\uFF1A",paraId:28,tocIndex:4},{value:"\u6548\u679C\u63CF\u8FF0\uFF1A\u5F53\u521B\u5EFA\u6210\u529F\u7684\u65F6\u5019\uFF0C\u4F1A\u6709\u4E00\u4E2A Toast \u63D0\u793A\u3002",paraId:29,tocIndex:4},{value:"\u4F46\u662F\u5427\uFF1A",paraId:30,tocIndex:4},{value:"Toast \u4ECE\u4E0B\u9762\u5F39\u51FA\uFF0C\u5982\u679C\u662F\u4ECE\u4E0A\u9762\u5F39\u51FA\u5C31\u597D\u4E86\u2026\u2026",paraId:31,tocIndex:4},{value:"Toast \u505C\u7559\u7684\u65F6\u95F4\u592A\u4E45\u4E86\uFF0C\u5982\u679C\u65F6\u95F4\u77ED\u70B9\u5C31\u597D\u4E86\u2026\u2026",paraId:31,tocIndex:4},{value:"\u8FD9\u5C31\u8981\u8BF4\u5230 Shadcn UI \u7684\u597D\u5904\u4E86\uFF0C\u90A3\u5C31\u662F\u53EF\u4EE5\u76F4\u63A5\u6539\u7EC4\u4EF6\u6E90\u7801\u3002",paraId:32,tocIndex:4},{value:"\u4FEE\u6539 ",paraId:33,tocIndex:4},{value:"src/components/ui/toast.tsx",paraId:33,tocIndex:4},{value:" \u7B2C 19 \u884C\u5DE6\u53F3\u4F4D\u7F6E\u7684\u6837\u5F0F\u4EE3\u7801\uFF0C\u4FEE\u6539\u4EE3\u7801\u5982\u4E0B\uFF1A",paraId:33,tocIndex:4},{value:`- fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:top-auto sm:bottom-0 sm:right-0 sm:flex-col md:max-w-[420px]
+ fixed top-0 left-[50%] z-[100] flex max-h-screen w-full translate-x-[-50%] flex-col-reverse p-4 sm:right-0 sm:flex-col md:max-w-[420px]
`,paraId:34,tocIndex:4},{value:"\u4FEE\u6539 ",paraId:35,tocIndex:4},{value:"src/components/ui/toaster.tsx",paraId:35,tocIndex:4},{value:"\uFF0C\u6DFB\u52A0\u4EE3\u7801\u5982\u4E0B\uFF1A",paraId:35,tocIndex:4},{value:`// ...

export function Toaster() {
  // ...

  return <ToastProvider duration={1000}>// ...</ToastProvider>;
}
`,paraId:36,tocIndex:4},{value:"\u6B64\u65F6\u6D4F\u89C8\u5668\u6548\u679C\u5982\u4E0B\uFF1A",paraId:37,tocIndex:4},{value:"\u65B0\u5EFA ",paraId:38,tocIndex:5},{value:"src/lib/prisma.ts",paraId:38,tocIndex:5},{value:"\uFF0C\u4EE3\u7801\u5982\u4E0B\uFF1A",paraId:38,tocIndex:5},{value:`// \u4EE3\u7801\u6765\u6E90\u4E8E\u5B98\u65B9\u6587\u6863\uFF1Ahttps://www.prisma.io/docs/orm/more/help-and-troubleshooting/help-articles/nextjs-prisma-client-dev-practices

import { PrismaClient } from "@prisma/client";

const prismaClientSingleton = () => {
  return new PrismaClient();
};

declare const globalThis: {
  prismaGlobal: ReturnType<typeof prismaClientSingleton>;
} & typeof global;

const prisma = globalThis.prismaGlobal ?? prismaClientSingleton();

export default prisma;

if (process.env.NODE_ENV !== "production") globalThis.prismaGlobal = prisma;
`,paraId:39,tocIndex:5},{value:"\u4FEE\u6539 ",paraId:40,tocIndex:5},{value:"prisma/schema.prisma",paraId:40,tocIndex:5},{value:"\uFF0C\u4EE3\u7801\u5982\u4E0B\uFF1A",paraId:40,tocIndex:5},{value:`// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "mysql"
    url      = env("DATABASE_URL")
}

model List {
    id        Int      @id @default(autoincrement())
    name      String
    userId    String
    color     String
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
}
`,paraId:41,tocIndex:5},{value:"\u56E0\u4E3A\u4FEE\u6539\u4E86 Schema\uFF0C\u6240\u4EE5\u8FD0\u884C\uFF1A",paraId:42,tocIndex:5},{value:`npx prisma migrate dev
`,paraId:43,tocIndex:5},{value:"\u4FEE\u6539 ",paraId:44,tocIndex:5},{value:"src/actions/list.ts",paraId:44,tocIndex:5},{value:"\uFF0C\u5B8C\u6574\u4EE3\u7801\u5982\u4E0B\uFF1A",paraId:44,tocIndex:5},{value:`'use server';

import {
  createListZodSchema,
  type createListZodSchemaType,
} from '@/schema/createList';
import { currentUser } from '@clerk/nextjs/server';
import { revalidatePath } from 'next/cache';
import prisma from '@/lib/prisma';

export async function createList(data: createListZodSchemaType) {
  const user = await currentUser();

  if (!user) {
    throw new Error('\u7528\u6237\u672A\u767B\u5F55\uFF0C\u8BF7\u5148\u767B\u5F55');
  }

  const result = createListZodSchema.safeParse(data);

  if (!result.success) {
    return {
      success: false,
      message: result.error.flatten().fieldErrors,
    };
  }

  await prisma.list.create({
    data: {
      userId: user.id,
      color: data.color,
      name: data.name,
    },
  });

  revalidatePath('/');

  return {
    success: true,
    message: '\u6E05\u5355\u521B\u5EFA\u6210\u529F',
  };
}
`,paraId:45,tocIndex:5},{value:"\u4E3A\u4E86\u68C0\u67E5\u662F\u5426\u771F\u7684\u5199\u5165\u6570\u636E\u5E93\uFF0C\u8FD0\u884C\uFF1A",paraId:46,tocIndex:5},{value:`npx prisma studio
`,paraId:47,tocIndex:5},{value:"\u6D4F\u89C8\u5668\u6548\u679C\u5982\u4E0B\uFF1A",paraId:48,tocIndex:5},{value:"\u6548\u679C\u63CF\u8FF0\uFF1A\u6E05\u5355\u521B\u5EFA\u6210\u529F\u540E\uFF0C\u6570\u636E\u5E93\u7684\u6570\u636E\u4E5F\u786E\u5B9E\u53D1\u751F\u4E86\u66F4\u65B0",paraId:49,tocIndex:5},{value:"\u4FEE\u6539 ",paraId:50,tocIndex:6},{value:"src/app/page.tsx",paraId:50,tocIndex:6},{value:"\uFF0C\u6DFB\u52A0\u4EE3\u7801\u5982\u4E0B\uFF1A",paraId:50,tocIndex:6},{value:`// ...
import { CheckLists } from '@/components/CheckLists';

// ...

export default function HomePage() {
  return (
    <main className="flex w-full flex-col items-center px-4">
      <Suspense fallback={<WelcomeFallback />}>
        <Welcome />
      </Suspense>
      <Suspense fallback={<WelcomeFallback />}>
        <CheckLists />
      </Suspense>
    </main>
  );
}
`,paraId:51,tocIndex:6},{value:"\u65B0\u5EFA ",paraId:52,tocIndex:6},{value:"src/components/CheckLists.tsx",paraId:52,tocIndex:6},{value:"\uFF0C\u4EE3\u7801\u5982\u4E0B\uFF1A",paraId:52,tocIndex:6},{value:`import prisma from '@/lib/prisma';
import { currentUser } from '@clerk/nextjs/server';
import { type List } from '@prisma/client';
import {
  Card,
  CardContent,
  CardFooter,
  CardHeader,
  CardTitle,
} from '@/components/ui/card';
import CheckListFooter from '@/components/CheckListFooter';

import { cn } from '@/lib/utils';
import { ListMap } from '@/lib/const';

interface Props {
  checkList: List;
}

function CheckList({ checkList }: Props) {
  const { name, color } = checkList;

  return (
    <Card
      className={cn('w-full text-white sm:col-span-2', ListMap.get(color))}
      x-chunk="dashboard-05-chunk-0"
    >
      <CardHeader>
        <CardTitle>{name}</CardTitle>
      </CardHeader>
      <CardContent>
        <p>\u4EFB\u52A1\u5217\u8868</p>
      </CardContent>
      <CardFooter className="flex-col pb-2">
        <CheckListFooter checkList={checkList} />
      </CardFooter>
    </Card>
  );
}

export async function CheckLists() {
  const user = await currentUser();
  const checkLists = await prisma.list.findMany({
    where: {
      userId: user?.id,
    },
  });

  if (checkLists.length === 0) {
    return <div className="mt-4">\u5C1A\u672A\u521B\u5EFA\u6E05\u5355\uFF0C\u8D76\u7D27\u521B\u5EFA\u4E00\u4E2A\u5427!</div>;
  }

  return (
    <>
      <div className="mt-6 flex w-full flex-col gap-4">
        {checkLists.map((checkList) => (
          <CheckList key={checkList.id} checkList={checkList} />
        ))}
      </div>
    </>
  );
}
`,paraId:53,tocIndex:6},{value:"\u65B0\u5EFA ",paraId:54,tocIndex:6},{value:"src/components/CheckListFooter.tsx",paraId:54,tocIndex:6},{value:"\uFF0C\u4EE3\u7801\u5982\u4E0B\uFF1A",paraId:54,tocIndex:6},{value:`'use client';

import {
  AlertDialog,
  AlertDialogAction,
  AlertDialogCancel,
  AlertDialogContent,
  AlertDialogDescription,
  AlertDialogFooter,
  AlertDialogHeader,
  AlertDialogTitle,
  AlertDialogTrigger,
} from '@/components/ui/alert-dialog';
import { Separator } from '@/components/ui/separator';
import { Button } from '@/components/ui/button';
import { Trash2, CirclePlus } from 'lucide-react';
import { type List } from '@prisma/client';

interface Props {
  checkList: List;
}

export default function CheckListFooter({ checkList }: Props) {
  const { createdAt } = checkList;

  const deleteCheckList = async () => {
    console.log(1);
  };

  return (
    <>
      <Separator />
      <footer className="flex h-[60px] w-full items-center justify-between text-sm text-white">
        <p>\u521B\u5EFA\u4E8E {createdAt.toLocaleDateString('zh-CN')}</p>
        <div>
          <Button size={'icon'} variant={'ghost'}>
            <CirclePlus />
          </Button>
          <AlertDialog>
            <AlertDialogTrigger asChild>
              <Button size={'icon'} variant={'ghost'}>
                <Trash2 />
              </Button>
            </AlertDialogTrigger>
            <AlertDialogContent>
              <AlertDialogHeader>
                <AlertDialogTitle>\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F</AlertDialogTitle>
                <AlertDialogDescription>\u8BE5\u64CD\u4F5C\u65E0\u6CD5\u64A4\u56DE</AlertDialogDescription>
              </AlertDialogHeader>
              <AlertDialogFooter>
                <AlertDialogCancel>\u53D6\u6D88</AlertDialogCancel>
                <AlertDialogAction onClick={deleteCheckList}>
                  \u786E\u5B9A
                </AlertDialogAction>
              </AlertDialogFooter>
            </AlertDialogContent>
          </AlertDialog>
        </div>
      </footer>
    </>
  );
}
`,paraId:55,tocIndex:6},{value:"\u6D4F\u89C8\u5668\u6548\u679C\u5982\u4E0B\uFF1A",paraId:56,tocIndex:6},{value:"\u6548\u679C\u63CF\u8FF0\uFF1A\u5F53\u521B\u5EFA\u6E05\u5355\u540E\uFF0C\u9996\u9875\u4F1A\u5237\u65B0\u51FA\u65B0\u5EFA\u7684\u4EFB\u52A1\u5217\u8868\uFF0C\u70B9\u51FB\u5220\u9664\u6309\u94AE\uFF0C\u4F1A\u51FA\u73B0\u5220\u9664\u5F39\u7A97\u3002",paraId:57,tocIndex:6},{value:"\u4FEE\u6539 ",paraId:58,tocIndex:7},{value:"src/actions/list.ts",paraId:58,tocIndex:7},{value:"\uFF0C\u6DFB\u52A0\u4EE3\u7801\u5982\u4E0B\uFF1A",paraId:58,tocIndex:7},{value:`export async function deleteList(id: number) {
  const user = await currentUser();
  if (!user) {
    throw new Error('\u7528\u6237\u672A\u767B\u5F55\uFF0C\u8BF7\u5148\u767B\u5F55');
  }

  await prisma.list.delete({
    where: {
      id: id,
      userId: user.id,
    },
  });

  revalidatePath('/');
}
`,paraId:59,tocIndex:7},{value:"\u4FEE\u6539 ",paraId:60,tocIndex:7},{value:"src/components/CheckListFooter.tsx",paraId:60,tocIndex:7},{value:"\uFF0C\u5B8C\u6574\u4EE3\u7801\u5982\u4E0B\uFF1A",paraId:60,tocIndex:7},{value:`'use client';

import {
  AlertDialog,
  AlertDialogAction,
  AlertDialogCancel,
  AlertDialogContent,
  AlertDialogDescription,
  AlertDialogFooter,
  AlertDialogHeader,
  AlertDialogTitle,
  AlertDialogTrigger,
} from '@/components/ui/alert-dialog';
import { Separator } from '@/components/ui/separator';
import { Button } from '@/components/ui/button';
import { Trash2, CirclePlus } from 'lucide-react';
import { toast } from '@/components/ui/use-toast';
import { type List } from '@prisma/client';
import { deleteList } from '@/actions/list';

interface Props {
  checkList: List;
}

export default function CheckListFooter({ checkList }: Props) {
  const { id, createdAt } = checkList;

  const deleteCheckList = async () => {
    try {
      await deleteList(id);
      toast({
        title: '\u64CD\u4F5C\u6210\u529F',
        description: '\u6E05\u5355\u5DF2\u7ECF\u5220\u9664',
      });
    } catch (e) {
      toast({
        title: '\u64CD\u4F5C\u5931\u8D25',
        description: '\u6E05\u5355\u5220\u9664\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5',
        variant: 'destructive',
      });
    }
  };

  return (
    <>
      <Separator />
      <footer className="flex h-[60px] w-full items-center justify-between text-sm text-white">
        <p>\u521B\u5EFA\u4E8E {createdAt.toLocaleDateString('zh-CN')}</p>
        <div>
          <Button size={'icon'} variant={'ghost'}>
            <CirclePlus />
          </Button>
          <AlertDialog>
            <AlertDialogTrigger asChild>
              <Button size={'icon'} variant={'ghost'}>
                <Trash2 />
              </Button>
            </AlertDialogTrigger>
            <AlertDialogContent>
              <AlertDialogHeader>
                <AlertDialogTitle>\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F</AlertDialogTitle>
                <AlertDialogDescription>\u8BE5\u64CD\u4F5C\u65E0\u6CD5\u64A4\u56DE</AlertDialogDescription>
              </AlertDialogHeader>
              <AlertDialogFooter>
                <AlertDialogCancel>\u53D6\u6D88</AlertDialogCancel>
                <AlertDialogAction onClick={deleteCheckList}>
                  \u786E\u5B9A
                </AlertDialogAction>
              </AlertDialogFooter>
            </AlertDialogContent>
          </AlertDialog>
        </div>
      </footer>
    </>
  );
}
`,paraId:61,tocIndex:7},{value:"\u6D4F\u89C8\u5668\u6548\u679C\u5982\u4E0B\uFF1A",paraId:62,tocIndex:7},{value:"\u529F\u80FD\u5B9E\u73B0\uFF1At3-app \u6E05\u5355\u589E\u5220\u67E5",paraId:63,tocIndex:8},{value:"\u6E90\u7801\u5730\u5740\uFF1A",paraId:63,tocIndex:8},{value:"https://github.com/mqyqingfeng/next-app-demo/tree/next-t3-todo-2",paraId:63,tocIndex:8},{value:"\u4E0B\u8F7D\u4EE3\u7801\uFF1A",paraId:63,tocIndex:8},{value:"git clone -b next-t3-todo-2 git@github.com:mqyqingfeng/next-app-demo.git",paraId:63,tocIndex:8},{value:"\u76EE\u524D\u6211\u4EEC\u5DF2\u7ECF\u5B9E\u73B0\u4E86\u6E05\u5355\u7684\u589E\u5220\u67E5\uFF0C\u63A5\u4E0B\u6765\u6211\u4EEC\u5B9E\u73B0\u6E05\u5355\u4E2D\u7684\u5177\u4F53\u4EFB\u52A1\u7684\u589E\u6539\u529F\u80FD\u3002",paraId:64,tocIndex:8}]}}]);

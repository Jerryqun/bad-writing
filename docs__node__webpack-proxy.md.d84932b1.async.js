"use strict";(self.webpackChunkblog_cq=self.webpackChunkblog_cq||[]).push([[177],{26916:function(d,t,a){a.r(t);var i=a(72269),E=a(93359),u=a(61788),x=a(19977),h=a(91558),r=a(24268),c=a(96057),p=a(85939),o=a(53683),s=a(80936),l=a(67294),n=a(77208),e=a(85893);function _(){return(0,e.jsx)(o.dY,{children:(0,e.jsx)(l.Suspense,{fallback:(0,e.jsx)(s.Z,{}),children:(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{className:"markdown",children:[(0,e.jsxs)("h1",{id:"webpack5prox-\u914D\u7F6E\u8BE6\u89E3",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#webpack5prox-\u914D\u7F6E\u8BE6\u89E3",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Webpack5Prox \u914D\u7F6E\u8BE6\u89E3"]}),(0,e.jsxs)("h2",{id:"\u539F\u7406",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#\u539F\u7406",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"\u539F\u7406\uFF1A"]}),(0,e.jsx)("p",{children:n.texts[0].value}),(0,e.jsx)(r.Z,{lang:"js",children:n.texts[1].value}),(0,e.jsxs)("h2",{id:"proxy-\u914D\u7F6E\u8BE6\u89E3",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#proxy-\u914D\u7F6E\u8BE6\u89E3",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"proxy \u914D\u7F6E\u8BE6\u89E3"]}),(0,e.jsx)(r.Z,{lang:"json",children:n.texts[2].value}),(0,e.jsxs)("h2",{id:"changeorigin-\u8BE6\u89E3",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#changeorigin-\u8BE6\u89E3",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"changeOrigin \u8BE6\u89E3"]}),(0,e.jsx)("p",{children:n.texts[3].value}),(0,e.jsxs)("p",{children:[n.texts[4].value,(0,e.jsx)("br",{}),n.texts[5].value,(0,e.jsx)("a",{href:"http://localhost:8080%EF%BC%8C%E8%80%8C%E4%BD%A0%E8%A6%81%E8%AF%B7%E6%B1%82%E7%9A%84",children:n.texts[6].value}),n.texts[7].value,(0,e.jsx)("a",{href:"http://api.example.com%E3%80%82%E6%8C%89%E7%85%A7%E5%90%8C%E6%BA%90%E7%AD%96%E7%95%A5%EF%BC%8C%E6%B5%8F%E8%A7%88%E5%99%A8%E4%BC%9A%E5%9C%A8%E5%8F%91%E8%B5%B7%E8%B7%A8%E5%9F%9F%E8%AF%B7%E6%B1%82%E6%97%B6%EF%BC%8C%E6%B7%BB%E5%8A%A0%E4%B8%80%E4%B8%AAOrigin%E5%AD%97%E6%AE%B5%EF%BC%8C%E5%80%BC%E4%B8%BA%E8%AF%B7%E6%B1%82%E5%8F%91%E8%B5%B7%E7%9A%84%E6%BA%90%EF%BC%88%E5%8D%B3http://localhost:8080%EF%BC%89%E3%80%82%E5%9C%A8%E5%90%8E%E7%AB%AF%E6%9C%8D%E5%8A%A1%E5%A4%84%EF%BC%8C%E5%A6%82%E6%9E%9C%E9%85%8D%E7%BD%AE%E4%BA%86%E8%B7%A8%E5%9F%9F%E8%B5%84%E6%BA%90%E5%85%B1%E4%BA%AB%EF%BC%88CORS%EF%BC%89%EF%BC%8C%E6%9C%8D%E5%8A%A1%E7%AB%AF%E4%BC%9A%E6%A3%80%E6%9F%A5",children:n.texts[8].value}),n.texts[9].value]}),(0,e.jsx)("p",{children:n.texts[10].value}),(0,e.jsx)("p",{children:n.texts[11].value}),(0,e.jsx)(r.Z,{lang:"json",children:n.texts[12].value}),(0,e.jsxs)("p",{children:[n.texts[13].value,(0,e.jsx)("a",{href:"http://localhost:8080",children:n.texts[14].value}),n.texts[15].value,(0,e.jsx)("a",{href:"http://api.example.com%E3%80%82%E5%A6%82%E6%9E%9C%E8%AE%BE%E7%BD%AE",children:n.texts[16].value}),n.texts[17].value,(0,e.jsx)("a",{href:"http://api.example.com%EF%BC%89%E3%80%82%E8%BF%99%E6%A0%B7%EF%BC%8CAPI%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%B0%B1%E4%BC%9A%E8%AE%A4%E4%B8%BA%E8%AF%B7%E6%B1%82%E6%98%AF%E4%BB%8E",children:n.texts[18].value}),n.texts[19].value,(0,e.jsx)("a",{href:"http://api.example.com",children:n.texts[20].value}),n.texts[21].value]}),(0,e.jsx)("p",{children:n.texts[22].value}),(0,e.jsxs)("h2",{id:"websocket-\u4EE3\u7406",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#websocket-\u4EE3\u7406",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"WebSocket \u4EE3\u7406"]}),(0,e.jsx)(r.Z,{lang:"json",children:n.texts[23].value})]})})})})}t.default=_},77208:function(d,t,a){a.r(t),a.d(t,{texts:function(){return i}});const i=[{value:"proxy \u5DE5\u4F5C\u539F\u7406\u5B9E\u8D28\u4E0A\u662F\u5229\u7528 http-proxy-middleware \u8FD9\u4E2A http \u4EE3\u7406\u4E2D\u95F4\u4EF6\uFF0C\u5B9E\u73B0\u8BF7\u6C42\u8F6C\u53D1\u7ED9\u5176\u4ED6\u670D\u52A1\u5668",paraId:0,tocIndex:1},{value:`const express = require('express');
const proxy = require('http-proxy-middleware');

const app = express();

app.use(
  '/api',
  proxy({ target: 'http://www.example.org', changeOrigin: true }),
);
app.listen(3000);

// http://localhost:3000/api/foo/bar -> http://www.example.org/api/foo/bar
`,paraId:1,tocIndex:1},{value:`{
  "proxy": {
    "/api": {
      "target": "http://localhost:3000", // \u76EE\u6807\u670D\u52A1\u5668\uFF0C\u6240\u6709\u5339\u914D\u5230\u7684\u8BF7\u6C42\u5C06\u4F1A\u88AB\u4EE3\u7406\u5230\u8FD9\u4E2A\u5730\u5740
      "pathRewrite": { "^/api": "" }, // pathRewrite\uFF1A\u91CD\u5199\u8BF7\u6C42\u8DEF\u5F84\u7684\u89C4\u5219\u3002 \u524D\u9762\u662F\u5339\u914D\u89C4\u5219\uFF0C\u540E\u9762\u662F\u66FF\u6362\u5185\u5BB9\uFF0C\u5C06/api\u66FF\u6362\u4E3A\u7A7A\uFF0C\u5373\u79FB\u9664\u8BF7\u6C42\u524D\u7F00
      "changeOrigin": true, // \u662F\u5426\u6539\u53D8\u8BF7\u6C42\u5934\u4E2D\u7684host\u503C\uFF0C\u5982\u679C\u8BBE\u7F6E\u4E3Atrue\uFF0C\u90A3\u4E48\u8BF7\u6C42\u5934\u4E2D\u7684host\u5C06\u88AB\u8BBE\u7F6E\u4E3Atarget
      "secure": false, // \u5982\u679C\u4EE3\u7406\u7684\u76EE\u6807\u662F HTTPS \u670D\u52A1\uFF0C\u5C06\u6B64\u9009\u9879\u8BBE\u7F6E\u4E3A false \u5C06\u5141\u8BB8\u4EE3\u7406\u670D\u52A1\u5668\u63A5\u53D7\u65E0\u6548\u7684\u8BC1\u4E66\u3002
      "logLevel": "debug", // \u65E5\u5FD7\u7EA7\u522B\uFF0C\u53EF\u9009\u9879\u6709'silent' | 'error' | 'warn' | 'info' | 'log' | 'debug'\u3002
      "context": ["/auth", "/api"], // \u53EA\u6709/auth\u548C/api\u5F00\u5934\u7684\u8BF7\u6C42\u624D\u4F1A\u88AB\u4EE3\u7406\uFF0C\u53EF\u4EE5\u662F\u4E00\u4E2A\u5355\u72EC\u7684\u5B57\u7B26\u4E32\u6216\u5B57\u7B26\u4E32\u6570\u7EC4
      "headers": {
        "Connection": "keep-alive" // \u4E3A\u6BCF\u4E00\u4E2A\u4EE3\u7406\u8BF7\u6C42\u6DFB\u52A0\u81EA\u5B9A\u4E49\u8BF7\u6C42\u5934
      },
      "cookiePathRewrite": "/", // \u91CD\u5199cookie\u8DEF\u5F84
      "cookieDomainRewrite": "localhost" ,// \u91CD\u5199cookie\u57DF\u540D
      "onProxyReq": function(proxyReq, req, res) { // \u4EE3\u7406\u7684\u8BF7\u6C42\u4E8B\u4EF6\u5904\u7406\uFF0C\u53EF\u4EE5\u5728\u8FD9\u91CC\u6DFB\u52A0\u8BF7\u6C42\u5934\u7B49
        proxyReq.setHeader('X-Added', 'foobar');
      },
      "onProxyRes": function(proxyRes, req, res) { // \u4EE3\u7406\u7684\u54CD\u5E94\u4E8B\u4EF6\u5904\u7406\uFF0C\u53EF\u4EE5\u5728\u8FD9\u91CC\u4FEE\u6539\u54CD\u5E94\u5934\u4FE1\u606F\u7B49
        proxyRes.headers['X-Added'] = 'foobar';  // \u6DFB\u52A0\u65B0\u7684\u54CD\u5E94\u5934\u5B57\u6BB5
      },
      "bypass": function(req, res, proxyOptions) { // \u63D0\u4F9B\u4E00\u4E2A\u51FD\u6570\u6765\u7ED5\u8FC7\u4EE3\u7406\u670D\u52A1\u5668\u53D1\u9001\u8BF7\u6C42\uFF0C\u8FD4\u56DEfalse\u5219\u7EE7\u7EED\u4EE3\u7406\uFF0C\u8FD4\u56DE\u5176\u4ED6\u8DEF\u5F84\u5219\u4E0D\u4EE3\u7406
        if (req.headers.accept.indexOf("html") !== -1) {
          console.log("Skipping proxy for browser request.");
          return "/index.html";
        }
      },
    },
  // \u5339\u914D\u4EFB\u4F55\u4E0D\u4E3A\u6839\u8DEF\u5F84\u7684\u8BF7\u6C42
    "/": {
        target: 'http://your_backend_server',
        changeOrigin: true,
        pathRewrite: (path) => {
          return path === '/' ? '/do-not-proxy' : path;
        }
  }
}
`,paraId:2,tocIndex:2},{value:"\u5F53\u542F\u7528 changeOrigin \u9009\u9879\u65F6\uFF0C\u4EE3\u7406\u670D\u52A1\u5668\u4F1A\u4FEE\u6539 HTTP \u8BF7\u6C42\u5934\u4E2D\u7684 Origin \u5B57\u6BB5\u3002Origin \u5B57\u6BB5\u7528\u4E8E\u6307\u793A\u8BF7\u6C42\u6765\u6E90\u4E8E\u54EA\u4E2A\u57DF\u3002\u8FD9\u5728\u8DE8\u57DF\u8BF7\u6C42\u4E2D\u662F\u975E\u5E38\u5173\u952E\u7684\uFF0C\u56E0\u4E3A\u670D\u52A1\u5668\u901A\u5E38\u4F1A\u68C0\u67E5 Origin \u5B57\u6BB5\uFF0C\u5E76\u5728\u57FA\u4E8E\u6B64\u5B57\u6BB5\u7684\u9A8C\u8BC1\u540E\u51B3\u5B9A\u662F\u5426\u63A5\u53D7\u8BF7\u6C42\u3002",paraId:3,tocIndex:3},{value:"\u573A\u666F\u5206\u6790",paraId:4,tocIndex:3},{value:`
\u5047\u8BBE\u4F60\u6B63\u5728\u5F00\u53D1\u4E00\u4E2A\u524D\u7AEF\u5E94\u7528\uFF0C\u8BE5\u5E94\u7528\u8FD0\u884C\u5728 `,paraId:4,tocIndex:3},{value:"http://localhost:8080\uFF0C\u800C\u4F60\u8981\u8BF7\u6C42\u7684",paraId:4,tocIndex:3},{value:" API \u4F4D\u4E8E\u4E0D\u540C\u7684\u57DF\u540D\u4E0B\uFF0C\u6BD4\u5982 ",paraId:4,tocIndex:3},{value:"http://api.example.com\u3002\u6309\u7167\u540C\u6E90\u7B56\u7565\uFF0C\u6D4F\u89C8\u5668\u4F1A\u5728\u53D1\u8D77\u8DE8\u57DF\u8BF7\u6C42\u65F6\uFF0C\u6DFB\u52A0\u4E00\u4E2AOrigin\u5B57\u6BB5\uFF0C\u503C\u4E3A\u8BF7\u6C42\u53D1\u8D77\u7684\u6E90\uFF08\u5373http://localhost:8080\uFF09\u3002\u5728\u540E\u7AEF\u670D\u52A1\u5904\uFF0C\u5982\u679C\u914D\u7F6E\u4E86\u8DE8\u57DF\u8D44\u6E90\u5171\u4EAB\uFF08CORS\uFF09\uFF0C\u670D\u52A1\u7AEF\u4F1A\u68C0\u67E5",paraId:4,tocIndex:3},{value:" Origin \u5B57\u6BB5\uFF0C\u9A8C\u8BC1\u8BF7\u6C42\u662F\u5426\u88AB\u5141\u8BB8\u3002",paraId:4,tocIndex:3},{value:`Proxy \u884C\u4E3A
\u5F53\u4E0D\u4F7F\u7528\u4EE3\u7406\u65F6\uFF0COrigin \u5B57\u6BB5\u7531\u6D4F\u89C8\u5668\u81EA\u52A8\u8BBE\u7F6E\uFF0C\u53CD\u6620\u4E86\u8BF7\u6C42\u5B9E\u9645\u6765\u81EA\u7684\u6E90\u5730\u5740\u3002\u4F46\u5982\u679C\u4F60\u4F7F\u7528 Webpack \u4EE3\u7406\uFF0C\u60C5\u51B5\u4F1A\u6709\u6240\u4E0D\u540C\uFF0C\u5C24\u5176\u662F\u5728\u5F00\u53D1\u73AF\u5883\u4E0B\uFF0C\u901A\u5E38\u9700\u8981\u4E00\u4E2A\u524D\u7AEF\u5F00\u53D1\u670D\u52A1\u5668\u5411 API \u670D\u52A1\u5668\u53D1\u8D77\u8BF7\u6C42\uFF0C\u6A21\u62DF\u751F\u4EA7\u73AF\u5883\u4E0B\u7684\u60C5\u51B5\u3002`,paraId:5,tocIndex:3},{value:`\u4F7F\u7528 changeOrigin
\u5982\u679C\u914D\u7F6E\u4E86\uFF1A`,paraId:6,tocIndex:3},{value:`{
  "proxy": {
    "/api": {
      "target": "http://api.example.com",
      "changeOrigin": true
    }
  }
}
`,paraId:7,tocIndex:3},{value:"\u5F53\u4F60\u4ECE ",paraId:8,tocIndex:3},{value:"http://localhost:8080",paraId:8,tocIndex:3},{value:" \u53D1\u8D77\u5230 /api \u7684\u8BF7\u6C42\u65F6\uFF0C\u4EE3\u7406\u4F1A\u63A5\u7BA1\u8BF7\u6C42\uFF0C\u5E76\u5C06\u5176\u8F6C\u53D1\u5230 ",paraId:8,tocIndex:3},{value:"http://api.example.com\u3002\u5982\u679C\u8BBE\u7F6E",paraId:8,tocIndex:3},{value:" changeOrigin: true\uFF0C\u4EE3\u7406\u4F1A\u5C06 HTTP \u8BF7\u6C42\u5934\u4E2D\u7684 Origin \u5B57\u6BB5\u4FEE\u6539\u4E3A\u76EE\u6807\u5730\u5740\u7684\u57DF\uFF08\u5373 ",paraId:8,tocIndex:3},{value:"http://api.example.com\uFF09\u3002\u8FD9\u6837\uFF0CAPI\u670D\u52A1\u5668\u5C31\u4F1A\u8BA4\u4E3A\u8BF7\u6C42\u662F\u4ECE",paraId:8,tocIndex:3},{value:" ",paraId:8,tocIndex:3},{value:"http://api.example.com",paraId:8,tocIndex:3},{value:" \u53D1\u8D77\u7684\uFF0C\u4ECE\u800C\u901A\u8FC7 CORS \u9A8C\u8BC1\u3002",paraId:8,tocIndex:3},{value:"\u6CE8\u610F\uFF1A \u5728\u5B9E\u9645\u7684\u751F\u4EA7\u73AF\u5883\u4E2D\uFF0COrigin \u5B57\u6BB5\u7684\u4FEE\u6539\u53EF\u80FD\u4F1A\u8FDD\u53CD CORS \u653F\u7B56\uFF0C\u6216\u88AB\u89C6\u4E3A\u6F5C\u5728\u7684\u5B89\u5168\u98CE\u9669\u3002\u56E0\u6B64\uFF0C\u8FD9\u79CD\u914D\u7F6E\u4E3B\u8981\u7528\u4E8E\u5F00\u53D1\u73AF\u5883\u4E2D\uFF0C\u4EE5\u4FBF\u5F00\u53D1\u4EBA\u5458\u80FD\u591F\u6A21\u62DF\u4E0D\u540C\u7684\u90E8\u7F72\u73AF\u5883\uFF0C\u5E76\u8FDB\u884C\u65E0\u5E72\u6270\u7684 API \u6D4B\u8BD5\u3002",paraId:9,tocIndex:3},{value:`{
  "proxy": {
    "/socket": {
      "target": "ws://localhost:3000",
      "ws": true
    }
  }
}
`,paraId:10,tocIndex:4}]}}]);

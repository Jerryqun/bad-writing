"use strict";(self.webpackChunkblog_cq=self.webpackChunkblog_cq||[]).push([[99],{26307:function(i,r,s){s.r(r);var t=s(72269),c=s(93359),d=s(61788),h=s(19977),p=s(91558),o=s(24268),_=s(96057),g=s(85939),l=s(53683),u=s(80936),a=s(67294),e=s(30540),n=s(85893);function m(){return(0,n.jsx)(l.dY,{children:(0,n.jsx)(a.Suspense,{fallback:(0,n.jsx)(u.Z,{}),children:(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"markdown",children:[(0,n.jsxs)("h2",{id:"\u5224\u65AD\u662F\u5426\u662F-promise-\u5BF9\u8C61",children:[(0,n.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#\u5224\u65AD\u662F\u5426\u662F-promise-\u5BF9\u8C61",children:(0,n.jsx)("span",{className:"icon icon-link"})}),"\u5224\u65AD\u662F\u5426\u662F promise \u5BF9\u8C61"]}),(0,n.jsx)(o.Z,{lang:"js",children:e.texts[0].value}),(0,n.jsxs)("h2",{id:"\u5E76\u53D1\u8BF7\u6C42\u6309\u7167\u987A\u5E8F\u4F9D\u6B21\u6253\u5370\u7ED3\u679C\u5E76\u884C",children:[(0,n.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#\u5E76\u53D1\u8BF7\u6C42\u6309\u7167\u987A\u5E8F\u4F9D\u6B21\u6253\u5370\u7ED3\u679C\u5E76\u884C",children:(0,n.jsx)("span",{className:"icon icon-link"})}),"\u5E76\u53D1\u8BF7\u6C42\u6309\u7167\u987A\u5E8F\u4F9D\u6B21\u6253\u5370\u7ED3\u679C(\u5E76\u884C)"]}),(0,n.jsx)(o.Z,{lang:"js",children:e.texts[1].value}),(0,n.jsxs)("h2",{id:"promiserace",children:[(0,n.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#promiserace",children:(0,n.jsx)("span",{className:"icon icon-link"})}),"Promise.race"]}),(0,n.jsx)(o.Z,{lang:"js",children:e.texts[2].value}),(0,n.jsxs)("h2",{id:"promiseallsettled",children:[(0,n.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#promiseallsettled",children:(0,n.jsx)("span",{className:"icon icon-link"})}),"promise.allSettled"]}),(0,n.jsx)("p",{children:e.texts[3].value}),(0,n.jsx)("p",{children:e.texts[4].value}),(0,n.jsxs)("h2",{id:"\u624B\u5199-promise",children:[(0,n.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#\u624B\u5199-promise",children:(0,n.jsx)("span",{className:"icon icon-link"})}),"\u624B\u5199 promise"]}),(0,n.jsx)(o.Z,{lang:"js",children:e.texts[5].value}),(0,n.jsxs)("h2",{id:"\u4F7F\u7528-promise-\u5B9E\u73B0\u6BCF\u9694-1-\u79D2\u8F93\u51FA-123",children:[(0,n.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#\u4F7F\u7528-promise-\u5B9E\u73B0\u6BCF\u9694-1-\u79D2\u8F93\u51FA-123",children:(0,n.jsx)("span",{className:"icon icon-link"})}),"\u4F7F\u7528 Promise \u5B9E\u73B0\u6BCF\u9694 1 \u79D2\u8F93\u51FA 1,2,3"]}),(0,n.jsx)(o.Z,{lang:"js",children:e.texts[6].value}),(0,n.jsxs)("h2",{id:"\u4EA4\u66FF\u95EE\u9898\u4F7F\u7528-promise-\u7684\u94FE\u5F0F\u8C03\u7528",children:[(0,n.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#\u4EA4\u66FF\u95EE\u9898\u4F7F\u7528-promise-\u7684\u94FE\u5F0F\u8C03\u7528",children:(0,n.jsx)("span",{className:"icon icon-link"})}),"\u4EA4\u66FF\u95EE\u9898\u4F7F\u7528 promise \u7684\u94FE\u5F0F\u8C03\u7528"]}),(0,n.jsx)(o.Z,{lang:"js",children:e.texts[7].value}),(0,n.jsxs)("h2",{id:"\u5B9E\u73B0-mergepromise-\u51FD\u6570",children:[(0,n.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#\u5B9E\u73B0-mergepromise-\u51FD\u6570",children:(0,n.jsx)("span",{className:"icon icon-link"})}),"\u5B9E\u73B0 mergePromise \u51FD\u6570"]}),(0,n.jsx)(o.Z,{lang:"js",children:e.texts[8].value}),(0,n.jsxs)("h2",{id:"\u5C01\u88C5\u4E00\u4E2A\u5F02\u6B65\u52A0\u8F7D\u56FE\u7247\u7684\u65B9\u6CD5",children:[(0,n.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#\u5C01\u88C5\u4E00\u4E2A\u5F02\u6B65\u52A0\u8F7D\u56FE\u7247\u7684\u65B9\u6CD5",children:(0,n.jsx)("span",{className:"icon icon-link"})}),"\u5C01\u88C5\u4E00\u4E2A\u5F02\u6B65\u52A0\u8F7D\u56FE\u7247\u7684\u65B9\u6CD5"]}),(0,n.jsx)(o.Z,{lang:"js",children:e.texts[9].value}),(0,n.jsxs)("h2",{id:"\u6267\u884C\u987A\u5E8F\u9898\u76EE",children:[(0,n.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#\u6267\u884C\u987A\u5E8F\u9898\u76EE",children:(0,n.jsx)("span",{className:"icon icon-link"})}),"\u6267\u884C\u987A\u5E8F\u9898\u76EE"]}),(0,n.jsx)(o.Z,{lang:"js",children:e.texts[10].value}),(0,n.jsxs)("h2",{id:"promise-\u503C\u7A7F\u900F",children:[(0,n.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#promise-\u503C\u7A7F\u900F",children:(0,n.jsx)("span",{className:"icon icon-link"})}),"Promise \u503C\u7A7F\u900F"]}),(0,n.jsx)("p",{children:e.texts[11].value}),(0,n.jsx)(o.Z,{lang:"js",children:e.texts[12].value}),(0,n.jsxs)("h2",{id:"promise-\u7684-then-\u65B9\u6CD5\u4EA4\u66FF\u6267\u884C",children:[(0,n.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#promise-\u7684-then-\u65B9\u6CD5\u4EA4\u66FF\u6267\u884C",children:(0,n.jsx)("span",{className:"icon icon-link"})}),"Promise \u7684 then \u65B9\u6CD5\u4EA4\u66FF\u6267\u884C"]}),(0,n.jsx)(o.Z,{lang:"js",children:e.texts[13].value}),(0,n.jsxs)("h2",{id:"promise-\u7684-then-\u4E2D\u8FD4\u56DE-promise-\u5B9E\u4F8B",children:[(0,n.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#promise-\u7684-then-\u4E2D\u8FD4\u56DE-promise-\u5B9E\u4F8B",children:(0,n.jsx)("span",{className:"icon icon-link"})}),"promise \u7684 then \u4E2D\u8FD4\u56DE promise \u5B9E\u4F8B"]}),(0,n.jsxs)("ol",{children:[(0,n.jsx)("li",{children:e.texts[14].value}),(0,n.jsx)("li",{children:e.texts[15].value}),(0,n.jsx)("li",{children:e.texts[16].value})]}),(0,n.jsx)(o.Z,{lang:"js",children:e.texts[17].value})]})})})})}r.default=m},30540:function(i,r,s){s.r(r),s.d(r,{texts:function(){return t}});const t=[{value:`function isPromise(val) {
  return typeof val.then === 'function' && typeof val.catch === 'function';
}
`,paraId:0,tocIndex:0},{value:`const sleep = (time, res) =>
  new Promise((resolve) =>
    setTimeout(() => {
      resolve(res);
    }, time),
  );

async function test() {
  const res1 = sleep(1000, 1);
  const res2 = sleep(2000, 2);
  const res3 = sleep(3000, 3);

  const result1 = await res1;
  const result2 = await res2;
  const result3 = await res3;

  console.log('result1', result1);
  console.log('result2', result2);
  console.log('result3', result3);
}
test();

// \u4E32\u884C (\u8FD4\u56DE\u6700\u540E\u4E00\u4E2Apromise \u72B6\u6001\u4E3A\u7ED3\u675F)

const result = [sleep(1000, 1), sleep(2000, 2), sleep(3000, 3)].reduce(
  (a, b) => a.then((res) => b),
  Promise.resolve(),
);
`,paraId:1,tocIndex:1},{value:`/**
 * Promise.race(iterable) \u65B9\u6CD5\u8FD4\u56DE\u4E00\u4E2A promise\uFF0C\u4E00\u65E6\u8FED\u4EE3\u5668\u4E2D\u7684\u67D0\u4E2A promise \u89E3\u51B3\u6216\u62D2\u7EDD\uFF0C\u8FD4\u56DE\u7684 promise \u5C31\u4F1A\u89E3\u51B3\u6216\u62D2\u7EDD\u3002
 */

const promise1 = new Promise((resolve, reject) => {
  setTimeout(resolve, 500, 'one');
});

const promise2 = new Promise((resolve, reject) => {
  setTimeout(resolve, 100, 'two');
});

Promise.race([promise1, promise2]).then((value) => {
  console.log(value);
  // Both resolve, but promise2 is faster
});
// expected output: "two"
`,paraId:2,tocIndex:2},{value:"Promise.allSettled() \u65B9\u6CD5\u8FD4\u56DE\u4E00\u4E2A\u5728\u6240\u6709\u7ED9\u5B9A\u7684 promise \u90FD\u5DF2\u7ECF fulfilled \u6216 rejected \u540E\u7684 promise\uFF0C\u5E76\u5E26\u6709\u4E00\u4E2A\u5BF9\u8C61\u6570\u7EC4\uFF0C\u6BCF\u4E2A\u5BF9\u8C61\u8868\u793A\u5BF9\u5E94\u7684 promise \u7ED3\u679C\u3002",paraId:3,tocIndex:3},{value:`Promise.allSettled(promises)\u53EF\u4EE5\u5E76\u884C\u5730\u8FD0\u884C promise\uFF0C\u5E76\u5C06\u72B6\u6001\uFF08fulfilled \u6216 reject\uFF09\u6536\u96C6\u5230\u4E00\u4E2A\u805A\u5408\u6570\u7EC4\u4E2D\u3002
Promise.allSettled(...)\u5728\u4F60\u9700\u8981\u6267\u884C\u5E73\u884C\u548C\u72EC\u7ACB\u7684\u5F02\u6B65\u64CD\u4F5C\u5E76\u6536\u96C6\u6240\u6709\u7ED3\u679C\u65F6\u975E\u5E38\u6709\u6548\uFF0C\u5373\u4F7F\u67D0\u4E9B\u5F02\u6B65\u64CD\u4F5C\u53EF\u80FD\u5931\u8D25\u3002`,paraId:4,tocIndex:3},{value:`class MyPromise {
  constructor(fn) {
    try {
      fn(this.resove, this.reject);
    } catch (err) {
      this.reject(err);
    }
  }
  status = 'pendding';
  result = '';
  onFulfilledCallbacks = [];
  onRejectedCallbacks = [];
  resove = (res) => {
    if (this.status === 'pendding') {
      this.status = 'fulfilled';
      this.result = res;
      while (this.onFulfilledCallbacks.length) {
        this.onFulfilledCallbacks.shift()(this.result);
      }
    }
  };
  reject = (err) => {
    if (this.status === 'pendding') {
      this.status = 'rejected';
      this.result = err;
      while (this.onRejectedCallbacks.length) {
        this.onRejectedCallbacks.shift()(this.result);
      }
    }
  };
  then = (resFn, errFn) => {
    let thenPromise = new MyPromise((resove, reject) => {});
    resFn = typeof resFn === 'function' ? resFn : () => {};
    errFn =
      typeof errFn === 'function'
        ? errFn
        : (reason) => {
            throw reason;
          };
    if (this.status === 'pendding') {
      this.onFulfilledCallbacks.push(resFn);
      this.onRejectedCallbacks.push(errFn);
    } else if (this.status === 'fulfilled') {
      this.onFulfilledCallbacks.push(resFn);
    } else {
      this.onRejectedCallbacks.push(errFn);
    }
    return thenPromise;
  };
}
`,paraId:5,tocIndex:4},{value:`/**
 * \u8FD9\u9053\u9898\u6BD4\u8F83\u7B80\u5355\u7684\u4E00\u79CD\u505A\u6CD5\u662F\u53EF\u4EE5\u7528Promise\u914D\u5408\u7740reduce\u4E0D\u505C\u7684\u5728promise\u540E\u9762\u53E0\u52A0.then
 */

const arr = [1, 2, 3];
arr.reduce((a, b) => {
  return a.then(() => {
    return new Promise((res, err) => {
      setTimeout(() => {
        res(console.log(b));
      }, 1000);
    });
  });
}, Promise.resolve());
`,paraId:6,tocIndex:5},{value:`/**
 * \u4EA4\u66FF\u95EE\u9898\u4F7F\u7528promise\u7684\u94FE\u5F0F\u8C03\u7528
 * \u4F7F\u7528Promise\u5B9E\u73B0\u7EA2\u7EFF\u706F\u4EA4\u66FF\u91CD\u590D\u4EAE
   \u7EA2\u706F3\u79D2\u4EAE\u4E00\u6B21\uFF0C\u9EC4\u706F2\u79D2\u4EAE\u4E00\u6B21\uFF0C\u7EFF\u706F1\u79D2\u4EAE\u4E00\u6B21\uFF1B\u5982\u4F55\u8BA9\u4E09\u4E2A\u706F\u4E0D\u65AD\u4EA4\u66FF\u91CD\u590D\u4EAE\u706F\uFF1F\uFF08\u7528Promise\u5B9E\u73B0\uFF09\u4E09\u4E2A\u4EAE\u706F\u51FD\u6570\u5DF2\u7ECF\u5B58\u5728\uFF1A
 */

function red() {
  console.log('red');
}
function green() {
  console.log('green');
}
function yellow() {
  console.log('yellow');
}
const light = function (timer, cb) {
  return new Promise((resolve) => {
    setTimeout(() => {
      cb();
      resolve();
    }, timer);
  });
};

const step = function () {
  Promise.resolve()
    .then(() => {
      return light(3000, red);
    })
    .then(() => {
      return light(2000, green);
    })
    .then(() => {
      return light(1000, yellow);
    })
    .then(() => {
      return step();
    });
};

step();
`,paraId:7,tocIndex:6},{value:`const time = (timer) => {
  return new Promise((resolve) => {
    setTimeout(resolve, timer);
  });
};

const ajax1 = () =>
  time(2000).then(() => {
    console.log(1);
    return 1;
  });
const ajax2 = () =>
  time(1000).then(() => {
    console.log(2);
    return 2;
  });
const ajax3 = () =>
  time(1000).then(() => {
    console.log(3);
    return 3;
  });

function mergePromise() {
  // \u5728\u8FD9\u91CC\u5199\u4EE3\u7801
}

mergePromise([ajax1, ajax2, ajax3]).then((data) => {
  console.log('done');
  console.log(data); // data \u4E3A [1, 2, 3]
});

// \u8981\u6C42\u5206\u522B\u8F93\u51FA
// 1
// 2
// 3
// done
// [1, 2, 3]

// \u89E3\u6CD5\u4E00 for \u5FAA\u73AF

async function mergePromise(promises) {
  let result = [];
  for (let i = 0; i < promises.length; i++) {
    const b = await promises[i]();
    result.push(b);
  }
  return Promise.resolve(result);
}

mergePromise([ajax1, ajax2, ajax3]).then((data) => {
  console.log('done');
  console.log(data); // data \u4E3A [1, 2, 3]
});

// \u89E3\u6CD5\u4E8C forEach \u5FAA\u73AF

const mergePromise = (promises) => {
  const data = [];
  let promise = Promise.resolve();
  promises.forEach((item) => {
    promise = promise.then(item).then((res) => {
      data.push(res);
      return data;
    });
  });
  return promise;
};
`,paraId:8,tocIndex:7},{value:`const loadImg = (src) => {
  return new Promise((resolve, reject) => {
    const img = document.createElement('img');
    img.src = src;
    img.onload = function () {
      resolve(img);
    };
    img.onerror = function (err) {
      reject(new Error('Could not load image at ' + url));
    };
  });
};

var urls = [
  'https://hexo-blog-1256114407.cos.ap-shenzhen-fsi.myqcloud.com/AboutMe-painting1.png',
  'https://hexo-blog-1256114407.cos.ap-shenzhen-fsi.myqcloud.com/AboutMe-painting2.png',
  'https://hexo-blog-1256114407.cos.ap-shenzhen-fsi.myqcloud.com/AboutMe-painting3.png',
  'https://hexo-blog-1256114407.cos.ap-shenzhen-fsi.myqcloud.com/AboutMe-painting4.png',
  'https://hexo-blog-1256114407.cos.ap-shenzhen-fsi.myqcloud.com/AboutMe-painting5.png',
  'https://hexo-blog-1256114407.cos.ap-shenzhen-fsi.myqcloud.com/bpmn6.png',
  'https://hexo-blog-1256114407.cos.ap-shenzhen-fsi.myqcloud.com/bpmn7.png',
  'https://hexo-blog-1256114407.cos.ap-shenzhen-fsi.myqcloud.com/bpmn8.png',
];
`,paraId:9,tocIndex:8},{value:`const promise = new Promise((resolve, reject) => {
  console.log(1);
  console.log(2);
});
promise.then(() => {
  console.log(3);
});
console.log(4);

/**
 * \u4ECE\u4E0A\u81F3\u4E0B\uFF0C\u5148\u9047\u5230new Promise\uFF0C\u6267\u884C\u5176\u4E2D\u7684\u540C\u6B65\u4EE3\u78011\u548C2
   \u8DF3\u51FApromise\uFF0C\u5F80\u4E0B\u6267\u884C\uFF0C\u78B0\u5230promise.then\u8FD9\u4E2A\u5FAE\u4EFB\u52A1\uFF0C\u5C06\u5176\u52A0\u5165\u5FAE\u4EFB\u52A1\u961F\u5217
   \u6267\u884C\u540C\u6B65\u4EE3\u78014 
   \u672C\u8F6E\u5B8F\u4EFB\u52A1\u5168\u90E8\u6267\u884C\u5B8C\u6BD5\uFF0C\u68C0\u67E5\u5FAE\u4EFB\u52A1\u961F\u5217\uFF0C\u53D1\u73B0promise.then\u8FD9\u4E2A\u5FAE\u4EFB\u52A1\u4E14\u72B6\u6001\u4E3A\u4E3Apengding  \u6240\u4EE5then\u4E0D\u4F1A\u6267\u884C\u3002
 */

const promise1 = new Promise((resolve, reject) => {
  console.log('promise1');
  resolve('resolve1');
});
const promise2 = promise1.then((res) => {
  console.log(res);
});
console.log('1', promise1);
console.log('2', promise2);

/**
 * \u4ECE\u4E0A\u81F3\u4E0B\uFF0C\u5148\u9047\u5230new Promise\uFF0C\u6267\u884C\u8BE5\u6784\u9020\u51FD\u6570\u4E2D\u7684\u4EE3\u7801promise1
\u78B0\u5230resolve\u51FD\u6570, \u5C06promise1\u7684\u72B6\u6001\u6539\u53D8\u4E3Aresolved, \u5E76\u5C06\u7ED3\u679C\u4FDD\u5B58\u4E0B\u6765
\u78B0\u5230promise1.then\u8FD9\u4E2A\u5FAE\u4EFB\u52A1\uFF0C\u5C06\u5B83\u653E\u5165\u5FAE\u4EFB\u52A1\u961F\u5217
promise2\u662F\u4E00\u4E2A\u65B0\u7684\u72B6\u6001\u4E3Apending\u7684Promise\`
\u6267\u884C\u540C\u6B65\u4EE3\u78011\uFF0C \u540C\u65F6\u6253\u5370\u51FApromise1\u7684\u72B6\u6001\u662Fresolved
\u6267\u884C\u540C\u6B65\u4EE3\u78012\uFF0C\u540C\u65F6\u6253\u5370\u51FApromise2\u7684\u72B6\u6001\u662Fpending
\u5B8F\u4EFB\u52A1\u6267\u884C\u5B8C\u6BD5\uFF0C\u67E5\u627E\u5FAE\u4EFB\u52A1\u961F\u5217\uFF0C\u53D1\u73B0promise1.then\u8FD9\u4E2A\u5FAE\u4EFB\u52A1\u4E14\u72B6\u6001\u4E3Aresolved\uFF0C\u6267\u884C\u5B83\u3002


promise1
1 Promise\xA0{<fulfilled>: 'resolve1'}
2 Promise\xA0{<pending>}
resolve1
 */

const fn = () =>
  new Promise((resolve, reject) => {
    console.log(1);
    resolve('success');
  });
console.log('start');
fn().then((res) => {
  console.log(res);
});

/**
 * start
 * 1
 * success
 * \u4E4B\u524D\u6211\u4EEC\u5F88\u5BB9\u6613\u5C31\u4EE5\u4E3A\u770B\u5230new Promise()\u5C31\u6267\u884C\u5B83\u7684\u7B2C\u4E00\u4E2A\u53C2\u6570\u51FD\u6570\u4E86\uFF0C\u5176\u5B9E\u8FD9\u662F\u4E0D\u5BF9\u7684\uFF0C
 * \u5C31\u50CF\u8FD9\u4E24\u9053\u9898\u4E2D\uFF0C\u6211\u4EEC\u5F97\u6CE8\u610F\u5B83\u662F\u4E0D\u662F\u88AB\u5305\u88F9\u5728\u51FD\u6570\u5F53\u4E2D\uFF0C\u5982\u679C\u662F\u7684\u8BDD\uFF0C\u53EA\u6709\u5728\u51FD\u6570\u8C03\u7528\u7684\u65F6\u5019\u624D\u4F1A\u6267\u884C\u3002
 */

console.log('start');
setTimeout(() => {
  console.log('time');
});
Promise.resolve().then(() => {
  console.log('resolve');
});
console.log('end');

/**
 * \u521A\u5F00\u59CB\u6574\u4E2A\u811A\u672C\u4F5C\u4E3A\u4E00\u4E2A\u5B8F\u4EFB\u52A1\u6765\u6267\u884C\uFF0C\u5BF9\u4E8E\u540C\u6B65\u4EE3\u7801\u76F4\u63A5\u538B\u5165\u6267\u884C\u6808\u8FDB\u884C\u6267\u884C\uFF0C\u56E0\u6B64\u5148\u6253\u5370\u51FAstart\u548Cend\u3002
setTimout\u4F5C\u4E3A\u4E00\u4E2A\u5B8F\u4EFB\u52A1\u88AB\u653E\u5165\u5B8F\u4EFB\u52A1\u961F\u5217(\u4E0B\u4E00\u4E2A)
Promise.then\u4F5C\u4E3A\u4E00\u4E2A\u5FAE\u4EFB\u52A1\u88AB\u653E\u5165\u5FAE\u4EFB\u52A1\u961F\u5217
\u672C\u6B21\u5B8F\u4EFB\u52A1\u6267\u884C\u5B8C\uFF0C\u68C0\u67E5\u5FAE\u4EFB\u52A1\uFF0C\u53D1\u73B0Promise.then\uFF0C\u6267\u884C\u5B83
\u63A5\u4E0B\u6765\u8FDB\u5165\u4E0B\u4E00\u4E2A\u5B8F\u4EFB\u52A1\uFF0C\u53D1\u73B0setTimeout\uFF0C\u6267\u884C\u3002
 */

console.log('start');
setTimeout(() => {
  console.log('time');
});
Promise.resolve().then(() => {
  Promise.resolve().then(() => {
    console.log('resolve2');
  });
  console.log('resolve1');
});
console.log('end');

/**
 * start
   end
   resolve1
   resolve2
   \u5982\u679C\u5FAE\u4EFB\u52A1\u91CC\u9762\u53C8\u6709\u5FAE\u4EFB\u52A1 \u4E5F\u4F1A\u6253\u5165\u5F53\u524D\u5FAE\u4EFB\u52A1\u961F\u5217  \u6267\u884C\u987A\u5E8F\u9075\u5FAA\u5148\u8FDB\u540E\u51FA\u539F\u5219
 */

const promise = new Promise((resolve, reject) => {
  console.log(1);
  setTimeout(() => {
    console.log('timerStart');
    resolve('success');
    console.log('timerEnd');
  }, 0);
  console.log(2);
});
promise.then((res) => {
  console.log(res);
});
console.log(4);

/**
1
2
4
timerStart
timerEnd
success
 * \u4ECE\u4E0A\u81F3\u4E0B\uFF0C\u5148\u9047\u5230new Promise\uFF0C\u6267\u884C\u8BE5\u6784\u9020\u51FD\u6570\u4E2D\u7684\u4EE3\u78011
\u7136\u540E\u78B0\u5230\u4E86\u5B9A\u65F6\u5668\uFF0C\u5C06\u8FD9\u4E2A\u5B9A\u65F6\u5668\u4E2D\u7684\u51FD\u6570\u653E\u5230\u4E0B\u4E00\u4E2A\u5B8F\u4EFB\u52A1\u7684\u5EF6\u8FDF\u961F\u5217\u4E2D\u7B49\u5F85\u6267\u884C \u6267\u884C\u540C\u6B65\u4EE3\u78012
\u8DF3\u51FApromise\u51FD\u6570\uFF0C\u9047\u5230promise.then\uFF0C\u4F46\u5176\u72B6\u6001\u8FD8\u662F\u4E3Apending\uFF0C\u8FD9\u91CC\u7406\u89E3\u4E3A\u5148\u4E0D\u6267\u884C \u6267\u884C\u540C\u6B65\u4EE3\u78014
\u4E00\u8F6E\u5FAA\u73AF\u8FC7\u540E\uFF0C\u8FDB\u5165\u7B2C\u4E8C\u6B21\u5B8F\u4EFB\u52A1\uFF0C\u53D1\u73B0\u5EF6\u8FDF\u961F\u5217\u4E2D\u6709setTimeout\u5B9A\u65F6\u5668\uFF0C\u6267\u884C\u5B83
\u9996\u5148\u6267\u884CtimerStart\uFF0C\u7136\u540E\u9047\u5230\u4E86resolve\uFF0C\u5C06promise\u7684\u72B6\u6001\u6539\u4E3Aresolved\u4E14\u4FDD\u5B58\u7ED3\u679C\u5E76\u5C06\u4E4B\u524D\u7684promise.then\u63A8\u5165\u5FAE\u4EFB\u52A1\u961F\u5217
\u7EE7\u7EED\u6267\u884C\u540C\u6B65\u4EE3\u7801timerEnd
\u5B8F\u4EFB\u52A1\u5168\u90E8\u6267\u884C\u5B8C\u6BD5\uFF0C\u67E5\u627E\u5FAE\u4EFB\u52A1\u961F\u5217\uFF0C\u53D1\u73B0promise.then\u8FD9\u4E2A\u5FAE\u4EFB\u52A1\uFF0C\u6267\u884C\u5B83
 */

setTimeout(() => {
  console.log('timer1');
  setTimeout(() => {
    console.log('timer3');
  }, 0);
}, 0);
setTimeout(() => {
  console.log('timer2');
}, 0);
console.log('start');

/**
"start"
"timer1"
"timer2"
"timer3"
 */

setTimeout(() => {
  console.log('timer1');
  Promise.resolve().then(() => {
    console.log('promise');
  });
}, 0);
setTimeout(() => {
  console.log('timer2');
}, 0);
console.log('start');

/**
 * \u8FD9\u4E24\u4E2A\u4F8B\u5B50\uFF0C\u770B\u7740\u597D\u50CF\u53EA\u662F\u628A\u7B2C\u4E00\u4E2A\u5B9A\u65F6\u5668\u4E2D\u7684\u5185\u5BB9\u6362\u4E86\u4E00\u4E0B\u800C\u5DF2\u3002
\u4E00\u4E2A\u662F\u4E3A\u5B9A\u65F6\u5668timer3\uFF0C\u4E00\u4E2A\u662F\u4E3APromise.then
\u4F46\u662F\u5982\u679C\u662F\u5B9A\u65F6\u5668timer3\u7684\u8BDD\uFF0C\u5B83\u4F1A\u5728timer2\u540E\u6267\u884C\uFF0C\u800CPromise.then\u5374\u662F\u5728timer2\u4E4B\u524D\u6267\u884C\u3002
\u4F60\u53EF\u4EE5\u8FD9\u6837\u7406\u89E3\uFF0CPromise.then\u662F\u5FAE\u4EFB\u52A1\uFF0C\u5B83\u4F1A\u88AB\u52A0\u5165\u5230\u672C\u8F6E\u4E2D\u7684\u5FAE\u4EFB\u52A1\u5217\u8868\uFF0C\u800C\u5B9A\u65F6\u5668timer3\u662F\u5B8F\u4EFB\u52A1\uFF0C\u5B83\u4F1A\u88AB\u52A0\u5165\u5230\u4E0B\u4E00\u8F6E\u7684\u5B8F\u4EFB\u52A1\u4E2D\u3002
\u7406\u89E3\u5B8C\u8FD9\u4E24\u4E2A\u6848\u4F8B\uFF0C\u53EF\u4EE5\u6765\u770B\u770B\u4E0B\u9762\u4E00\u9053\u6BD4\u8F83\u96BE\u7684\u9898\u76EE\u4E86

'start'
'timer1'
'promise'
'timer2'
 */

Promise.resolve().then(() => {
  console.log('promise1');
  const timer2 = setTimeout(() => {
    console.log('timer2');
  }, 0);
});
const timer1 = setTimeout(() => {
  console.log('timer1');
  Promise.resolve().then(() => {
    console.log('promise2');
  });
}, 0);
console.log('start');

/**
 * \u521A\u5F00\u59CB\u6574\u4E2A\u811A\u672C\u4F5C\u4E3A\u7B2C\u4E00\u6B21\u5B8F\u4EFB\u52A1\u6765\u6267\u884C\uFF0C\u6211\u4EEC\u5C06\u5B83\u6807\u8BB0\u4E3A\u5B8F1\uFF0C\u4ECE\u4E0A\u81F3\u4E0B\u6267\u884C
\u9047\u5230Promise.resolve().then\u8FD9\u4E2A\u5FAE\u4EFB\u52A1\uFF0C\u5C06then\u4E2D\u7684\u5185\u5BB9\u52A0\u5165\u7B2C\u4E00\u6B21\u7684\u5FAE\u4EFB\u52A1\u961F\u5217\u6807\u8BB0\u4E3A\u5FAE1
\u9047\u5230\u5B9A\u65F6\u5668timer1\uFF0C\u5C06\u5B83\u52A0\u5165\u4E0B\u4E00\u6B21\u5B8F\u4EFB\u52A1\u7684\u5EF6\u8FDF\u5217\u8868\uFF0C\u6807\u8BB0\u4E3A\u5B8F2\uFF0C\u7B49\u5F85\u6267\u884C(\u5148\u4E0D\u7BA1\u91CC\u9762\u662F\u4EC0\u4E48\u5185\u5BB9)
\u6267\u884C\u5B8F1\u4E2D\u7684\u540C\u6B65\u4EE3\u7801start
\u7B2C\u4E00\u6B21\u5B8F\u4EFB\u52A1(\u5B8F1)\u6267\u884C\u5B8C\u6BD5\uFF0C\u68C0\u67E5\u7B2C\u4E00\u6B21\u7684\u5FAE\u4EFB\u52A1\u961F\u5217(\u5FAE1)\uFF0C\u53D1\u73B0\u6709\u4E00\u4E2Apromise.then\u8FD9\u4E2A\u5FAE\u4EFB\u52A1\u9700\u8981\u6267\u884C
\u6267\u884C\u6253\u5370\u51FA\u5FAE1\u4E2D\u540C\u6B65\u4EE3\u7801promise1\uFF0C\u7136\u540E\u53D1\u73B0\u5B9A\u65F6\u5668timer2\uFF0C\u5C06\u5B83\u52A0\u5165\u5B8F2\u7684\u540E\u9762\uFF0C\u6807\u8BB0\u4E3A\u5B8F3
\u7B2C\u4E00\u6B21\u5FAE\u4EFB\u52A1\u961F\u5217(\u5FAE1)\u6267\u884C\u5B8C\u6BD5\uFF0C\u6267\u884C\u7B2C\u4E8C\u6B21\u5B8F\u4EFB\u52A1(\u5B8F2)\uFF0C\u9996\u5148\u6267\u884C\u540C\u6B65\u4EE3\u7801timer1
\u7136\u540E\u9047\u5230\u4E86promise2\u8FD9\u4E2A\u5FAE\u4EFB\u52A1\uFF0C\u5C06\u5B83\u52A0\u5165\u6B64\u6B21\u5FAA\u73AF\u7684\u5FAE\u4EFB\u52A1\u961F\u5217\uFF0C\u6807\u8BB0\u4E3A\u5FAE2
\u5B8F2\u4E2D\u6CA1\u6709\u540C\u6B65\u4EE3\u7801\u53EF\u6267\u884C\u4E86\uFF0C\u67E5\u627E\u672C\u6B21\u5FAA\u73AF\u7684\u5FAE\u4EFB\u52A1\u961F\u5217(\u5FAE2)\uFF0C\u53D1\u73B0\u4E86promise2\uFF0C\u6267\u884C\u5B83
\u7B2C\u4E8C\u8F6E\u6267\u884C\u5B8C\u6BD5\uFF0C\u6267\u884C\u5B8F3\uFF0C\u6253\u5370\u51FAtimer2

'start'
'promise1'
'timer1'
'promise2'
'timer2'
 */
`,paraId:10,tocIndex:9},{value:"\u5728 JavaScript \u4E2D\uFF0CPromise \u662F\u4E00\u79CD\u7528\u4E8E\u5904\u7406\u5F02\u6B65\u64CD\u4F5C\u7684\u5BF9\u8C61\u3002\u5F53\u6211\u4EEC\u63D0\u5230\u201CPromise \u503C\u7A7F\u900F\u201D\uFF0C\u901A\u5E38\u662F\u6307 Promise \u94FE\u5F0F\u8C03\u7528\u4E2D\u7684\u503C\u4F20\u9012\u6216\u94FE\u5F0F\u6267\u884C\u7684\u8FC7\u7A0B\u3002\u5728\u8FD9\u4E2A\u8FC7\u7A0B\u4E2D\uFF0CPromise \u7684\u8FD4\u56DE\u503C\u4F1A\u4F20\u9012\u7ED9\u4E0B\u4E00\u4E2A .then() \u65B9\u6CD5\u3002",paraId:11,tocIndex:10},{value:`const promise1 = new Promise((resolve, reject) => {
  setTimeout(() => {
    resolve(1); // \u521D\u59CB\u503C
  }, 1000);
});

promise1
  .then((result) => {
    console.log(result); // \u8F93\u51FA 1
    return result + 1; // \u8FD4\u56DE 2
  })
  .then((result) => {
    console.log(result); // \u8F93\u51FA 2
    return new Promise((resolve, reject) => {
      setTimeout(() => {
        resolve(result + 1); // \u8FD4\u56DE 3
      }, 1000);
    });
  })
  .then((result) => {
    console.log(result); // \u8F93\u51FA 3
  })
  .catch((error) => {
    console.error(error);
  });
`,paraId:12,tocIndex:10},{value:`Promise.resolve()
  .then(() => console.log('1'))
  .then(() => console.log('3'));
Promise.resolve()
  .then(() => console.log('2'))
  .then(() => console.log('4'));

// 1234
`,paraId:13,tocIndex:11},{value:"\u76F8\u5F53\u4E8E\u591A\u51FA\u4E00\u4E2A promise \u5B9E\u4F8B",paraId:14,tocIndex:12},{value:"\u4E5F\u4F1A\u9075\u5FAA\u4EA4\u66FF\u6267\u884C",paraId:14,tocIndex:12},{value:"\u4F46\u662F\u548C\u76F4\u63A5\u58F0\u660E\u4E00\u4E2A promise \u5B9E\u4F8B\uFF0C\u7ED3\u679C\u6709\u4E9B\u5DEE\u5F02\uFF08\u6162\u4E24\u62CD,\u540E\u7EED\u518D\u8FDB\u884C\u4EA4\u66FF\u6267\u884C\uFF09",paraId:14,tocIndex:12},{value:`Promise.resolve()
  .then(() => {
    console.log('1');
    return Promise.resolve(5);
  })
  .then(() => console.log('3'))
  .then(() => console.log('6'));

Promise.resolve()
  .then(() => console.log('2'))
  .then(() => console.log('4'))
  .then(() => console.log('7'))
  .then(() => console.log('8'));

// 1247386
`,paraId:15,tocIndex:12}]}}]);

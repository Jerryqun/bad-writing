"use strict";(self.webpackChunkblog_cq=self.webpackChunkblog_cq||[]).push([[9071],{73046:function(r,_,e){e.r(_);var i=e(72269),l=e(93359),x=e(61788),c=e(19977),h=e(91558),a=e(24268),E=e(96057),m=e(85939),t=e(53683),u=e(80936),s=e(67294),d=e(14082),n=e(85893);function o(){return(0,n.jsx)(t.dY,{children:(0,n.jsx)(s.Suspense,{fallback:(0,n.jsx)(u.Z,{}),children:(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"markdown",children:[(0,n.jsxs)("h1",{id:"\u53CD\u5411\u4EE3\u7406\u4E0E\u6B63\u5411\u4EE3\u7406",children:[(0,n.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#\u53CD\u5411\u4EE3\u7406\u4E0E\u6B63\u5411\u4EE3\u7406",children:(0,n.jsx)("span",{className:"icon icon-link"})}),"\u53CD\u5411\u4EE3\u7406\u4E0E\u6B63\u5411\u4EE3\u7406"]}),(0,n.jsx)("p",{children:(0,n.jsx)("a",{target:"_blank",href:"https://juejin.cn/post/6844904064266960903?searchId=20230712200442E5A62CE23F42D1F4763D",children:d.texts[0].value})}),(0,n.jsxs)("h2",{id:"\u6B63\u5411\u4EE3\u7406",children:[(0,n.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#\u6B63\u5411\u4EE3\u7406",children:(0,n.jsx)("span",{className:"icon icon-link"})}),"\u6B63\u5411\u4EE3\u7406"]}),(0,n.jsxs)("p",{children:[d.texts[1].value,(0,n.jsx)("code",{children:d.texts[2].value}),d.texts[3].value]}),(0,n.jsxs)("h2",{id:"\u53CD\u5411\u4EE3\u7406",children:[(0,n.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#\u53CD\u5411\u4EE3\u7406",children:(0,n.jsx)("span",{className:"icon icon-link"})}),"\u53CD\u5411\u4EE3\u7406"]}),(0,n.jsxs)("p",{children:[d.texts[4].value,(0,n.jsx)("code",{children:d.texts[5].value}),d.texts[6].value]}),(0,n.jsxs)("h2",{id:"nginx-\u53CD\u5411\u4EE3\u7406\u63A5\u53E3\u8DE8\u57DF",children:[(0,n.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#nginx-\u53CD\u5411\u4EE3\u7406\u63A5\u53E3\u8DE8\u57DF",children:(0,n.jsx)("span",{className:"icon icon-link"})}),"nginx \u53CD\u5411\u4EE3\u7406\u63A5\u53E3\u8DE8\u57DF"]}),(0,n.jsx)(a.Z,{lang:"bash",children:d.texts[7].value}),(0,n.jsxs)("h2",{id:"nodejs-\u4E2D\u95F4\u4EF6\u4EE3\u7406\u8DE8\u57DF",children:[(0,n.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#nodejs-\u4E2D\u95F4\u4EF6\u4EE3\u7406\u8DE8\u57DF",children:(0,n.jsx)("span",{className:"icon icon-link"})}),"nodejs \u4E2D\u95F4\u4EF6\u4EE3\u7406\u8DE8\u57DF"]}),(0,n.jsx)("p",{children:d.texts[8].value}),(0,n.jsx)(a.Z,{lang:"js",children:d.texts[9].value}),(0,n.jsx)("p",{children:d.texts[10].value}),(0,n.jsx)(a.Z,{lang:"js",children:d.texts[11].value})]})})})})}_.default=o},14082:function(r,_,e){e.r(_),e.d(_,{texts:function(){return i}});const i=[{value:"\u53C2\u8003",paraId:0,tocIndex:0},{value:"\u662F\u4E00\u4E2A\u4F4D\u4E8E\u5BA2\u6237\u7AEF\u548C\u76EE\u6807\u670D\u52A1\u5668\u4E4B\u95F4\u7684\u4EE3\u7406\u670D\u52A1\u5668(",paraId:1,tocIndex:1},{value:"\u4E2D\u95F4\u670D\u52A1\u5668",paraId:1,tocIndex:1},{value:")\u3002\u4E3A\u4E86\u4ECE\u539F\u59CB\u670D\u52A1\u5668\u53D6\u5F97\u5185\u5BB9\uFF0C\u5BA2\u6237\u7AEF\u5411\u4EE3\u7406\u670D\u52A1\u5668\u53D1\u9001\u4E00\u4E2A\u8BF7\u6C42\uFF0C\u5E76\u4E14\u6307\u5B9A\u76EE\u6807\u670D\u52A1\u5668\uFF0C\u4E4B\u540E\u4EE3\u7406\u5411\u76EE\u6807\u670D\u52A1\u5668\u8F6C\u4EA4\u5E76\u4E14\u5C06\u83B7\u5F97\u7684\u5185\u5BB9\u8FD4\u56DE\u7ED9\u5BA2\u6237\u7AEF\u3002\u6B63\u5411\u4EE3\u7406\u7684\u60C5\u51B5\u4E0B\u5BA2\u6237\u7AEF\u5FC5\u987B\u8981\u8FDB\u884C\u4E00\u4E9B\u7279\u522B\u7684\u8BBE\u7F6E\u624D\u80FD\u4F7F\u7528\u3002",paraId:1,tocIndex:1},{value:"\u6B63\u597D\u76F8\u53CD\u3002\u5BF9\u4E8E\u5BA2\u6237\u7AEF\u6765\u8BF4\uFF0C\u53CD\u5411\u4EE3\u7406\u5C31\u597D\u50CF\u76EE\u6807\u670D\u52A1\u5668\u3002\u5E76\u4E14\u5BA2\u6237\u7AEF\u4E0D\u9700\u8981\u8FDB\u884C\u4EFB\u4F55\u8BBE\u7F6E\u3002\u5BA2\u6237\u7AEF\u5411\u53CD\u5411\u4EE3\u7406\u53D1\u9001\u8BF7\u6C42\uFF0C",paraId:2,tocIndex:2},{value:"\u63A5\u7740\u53CD\u5411\u4EE3\u7406\u5224\u65AD\u8BF7\u6C42\u8D70\u5411\u4F55\u5904\uFF0C\u5E76\u5C06\u8BF7\u6C42\u8F6C\u4EA4\u7ED9\u5BA2\u6237\u7AEF",paraId:2,tocIndex:2},{value:"\uFF0C\u4F7F\u5F97\u8FD9\u4E9B\u5185\u5BB9\u5C31\u597D\u4F3C\u4ED6\u81EA\u5DF1\u4E00\u6837\uFF0C\u4E00\u6B21\u5BA2\u6237\u7AEF\u5E76\u4E0D\u4F1A\u611F\u77E5\u5230\u53CD\u5411\u4EE3\u7406\u540E\u9762\u7684\u670D\u52A1\uFF0C\u4E5F\u56E0\u6B64\u4E0D\u9700\u8981\u5BA2\u6237\u7AEF\u505A\u4EFB\u4F55\u8BBE\u7F6E\uFF0C\u53EA\u9700\u8981\u628A\u53CD\u5411\u4EE3\u7406\u670D\u52A1\u5668\u5F53\u6210\u771F\u6B63\u7684\u670D\u52A1\u5668\u5C31\u597D\u4E86\u3002",paraId:2,tocIndex:2},{value:`#proxy\u670D\u52A1\u5668
server {
    listen       81;
    server_name  www.domain1.com;

    location / {
        proxy_pass   http://www.domain2.com:8080;  #\u53CD\u5411\u4EE3\u7406
        proxy_cookie_domain www.domain2.com www.domain1.com; #\u4FEE\u6539cookie\u91CC\u57DF\u540D
        index  index.html index.htm;

        # \u5F53\u7528webpack-dev-server\u7B49\u4E2D\u95F4\u4EF6\u4EE3\u7406\u63A5\u53E3\u8BBF\u95EEnignx\u65F6\uFF0C\u6B64\u65F6\u65E0\u6D4F\u89C8\u5668\u53C2\u4E0E\uFF0C\u6545\u6CA1\u6709\u540C\u6E90\u9650\u5236\uFF0C\u4E0B\u9762\u7684\u8DE8\u57DF\u914D\u7F6E\u53EF\u4E0D\u542F\u7528
        add_header Access-Control-Allow-Origin http://www.domain1.com;  #\u5F53\u524D\u7AEF\u53EA\u8DE8\u57DF\u4E0D\u5E26cookie\u65F6\uFF0C\u53EF\u4E3A*
        add_header Access-Control-Allow-Credentials true;
    }
}
`,paraId:3,tocIndex:3},{value:"\u524D\u7AEF\u4EE3\u7801",paraId:4,tocIndex:4},{value:`var xhr = new XMLHttpRequest();

// \u524D\u7AEF\u5F00\u5173\uFF1A\u6D4F\u89C8\u5668\u662F\u5426\u8BFB\u5199cookie
xhr.withCredentials = true;

// \u8BBF\u95EEhttp-proxy-middleware\u4EE3\u7406\u670D\u52A1\u5668
xhr.open('get', 'http://www.domain1.com:3000/login?user=admin', true);
xhr.send();
`,paraId:5,tocIndex:4},{value:"\u4E2D\u95F4\u4EF6\u670D\u52A1\u5668\u4EE3\u7801",paraId:6,tocIndex:4},{value:`var express = require('express');
var proxy = require('http-proxy-middleware');
var app = express();

app.use(
  '/',
  proxy({
    // \u4EE3\u7406\u8DE8\u57DF\u76EE\u6807\u63A5\u53E3
    target: 'http://www.domain2.com:8080',
    changeOrigin: true,

    // \u4FEE\u6539\u54CD\u5E94\u5934\u4FE1\u606F\uFF0C\u5B9E\u73B0\u8DE8\u57DF\u5E76\u5141\u8BB8\u5E26cookie
    onProxyRes: function (proxyRes, req, res) {
      res.header('Access-Control-Allow-Origin', 'http://www.domain1.com');
      res.header('Access-Control-Allow-Credentials', 'true');
    },

    // \u4FEE\u6539\u54CD\u5E94\u4FE1\u606F\u4E2D\u7684cookie\u57DF\u540D
    cookieDomainRewrite: 'www.domain1.com', // \u53EF\u4EE5\u4E3Afalse\uFF0C\u8868\u793A\u4E0D\u4FEE\u6539
  }),
);

app.listen(3000);
console.log('Proxy server is listen at port 3000...');
`,paraId:7,tocIndex:4}]}}]);

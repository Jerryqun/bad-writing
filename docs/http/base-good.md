---
nav: Http
group:
  title: 网络知识
  order: 1
toc: content
title: 网络优化
mobile: false
---

## 网络优化

### DNS 预解析

link 标签的 rel 属性设置 dns-prefetch，提前获取域名对应的 IP 地址

一般来说，一次 DNS 解析需要耗费 20-120ms，所以为了优化 DNS，我们可以考虑两个方向：

1、减少 DNS 请求次数  
2、缩短 DNS 解析时间 dns-prefetch

注意事项

`dns-prefetch 仅对跨域域上的 DNS 查找有效，因此请避免使用它来指向相同域。这是因为，到浏览器看到提示时，您站点域背后的 IP 已经被解析`。

除了 link 还可以通过使用 HTTP 链接字段将 dns-prefetch（以及其他资源提示）指定为 HTTP 标头：

Link: <https://fonts.gstatic.com/>; rel=dns-prefetch

为什么要用 dns-prefetch

每当浏览器从（第三方）服务器发送一次请求时，都要先通过 DNS 解析将该跨域域名解析为 IP 地址，然后浏览器才能发出请求。
如果某一时间内，有多个请求都发送给同一个服务器，那么 DNS 解析会多次并且重复触发。这样会导致整体的网页加载有延迟的情况。
我们知道，虽然 DNS 解析占用不了多大带宽，但是它会产生很高的延迟，尤其是对于移动网络会更为明显。
因此，为了减少 DNS 解析产生的延迟，我们可以通过 dns-prefetch 预解析技术有效地缩短 DNS 解析时间

```html
<link rel="dns-prefetch" href="https://www.example.com" />
```

### 缓存

减轻服务端压力，快速得到数据

### 使用 CDN（内容分发网络）

用户与服务器的物理距离对响应时间也有影响。  
内容分发网络（CDN）是一组分散在不同地理位置的 web 服务器，用来给用户更高效地发送内容。  
典型地，选择用来发送内容的服务器是基于网络距离的衡量标准的。例如：选跳数（hop）最少的或者响应时间最快的服务器。

### 压缩响应

压缩组件通过减少 HTTP 请求产生的响应包的大小，从而降低传输时间的方式来提高性能。从 HTTP1.1 开始，Web 客户端可以通过 HTTP 请求中的 Accept-Encoding 头来标识对压缩的支持（这个请求头会列出一系列的压缩方法）
如果 Web 服务器看到请求中的这个头，就会使用客户端列出的方法中的一种来压缩响应。Web 服务器通过响应中的  Content-Encoding  头来告知 Web 客户端使用哪种方法进行的压缩  
目前许多网站通常会压缩 HTML 文档，脚本和样式表的压缩也是值得的（包括 XML 和 JSON 在内的任何文本响应理论上都值得被压缩）。但是，图片和 PDF 文件不应该被压缩，因为它们本来已经被压缩了。

### 使用多个域名

Chrome 等现代化浏览器，`都会有同域名限制并发下载数的情况`，不同的浏览器及版本都不一样，使用不同的域名可以最大化下载线程，但注意保持在 2~4 个域名内，以避免 DNS 查询损耗。

### 避免图片 src 为空

虽然 src 属性为空字符串，但浏览器仍然会向服务器发起一个 HTTP 请求：  
IE 向页面所在的目录发送请求； Safari、Chrome、Firefox 向页面本身发送请求； Opera 不执行任何操作
